@inject ApplicationDbContext _context
@*@inject Microsoft.AspNetCore.Identity.UserManager<ApplicationUser> _userManager*@
@inject ApplicationDbContext _db
@inject IDDLHelper _ddlHelper

@inject IDDLHelper _ddlhelper
@{
    ViewData["Title"] = "Dashboard";
      Layout = "~/Views/Shared/_AdminLayout.cshtml";
    var from = this.Context.Request.Query["from"];
    var person = this.Context.Request.Query["searchInput"];
    int day = 0;
    string userName = "";
    string itemNamePartial = "";
    string personNamePartial = "";
    int daay = 0;
    int month = 0;
    int year = 0;



    string OrderDate = "";
    DateTime OD = DateTime.Now;
    int lastUpdate = 1;
    int subMenuDetect = 1;
    int subMenuDetect2 = 1;
    int subMenuDetect3 = 1;
    int subMenuDetect4 = 1;


    //OrderDate = DateTime.Now.ToShortDateString();
    string UserId = "";
    if (ViewBag.submenu != null)
    {

        lastUpdate = ViewBag.submenu;
    }
    if (ViewBag.person != null)
    {
        personNamePartial = ViewBag.person;
    }
    if (ViewBag.item != null)
    {
        itemNamePartial = ViewBag.item;
    }
    if (ViewBag.MealId != null)
    {
        lastUpdate = ViewBag.MealId;
    }
    if (ViewBag.SubMenuId != null)
    {
        if (lastUpdate == 1)
        {
            subMenuDetect = ViewBag.SubMenuId;
        }
        else if (lastUpdate == 3)
        {
            subMenuDetect2 = ViewBag.SubMenuId;
        }
        else if (lastUpdate == 2)
        {
            subMenuDetect3 = ViewBag.SubMenuId;
        }
        else
        {
            subMenuDetect4 = ViewBag.SubMenuId;

        }
    }
    if (ViewBag.OrderDate != null)
    {
        day = (int)ViewBag.OrderDate.DayOfWeek + 1;

        OrderDate = ViewBag.OrderDate.ToShortDateString();
        OD = ViewBag.OrderDate;
        string[] Datearray = OrderDate.Split("/");
        daay = Int32.Parse(Datearray[1]);
        month = Int32.Parse(Datearray[0]);
        year = Int32.Parse(Datearray[2]);
    }
    else
    {
        day = (int)DateTime.Today.DayOfWeek + 1;
        OrderDate = DateTime.Now.ToShortDateString();
        string[] Datearray = OrderDate.Split("/");
        daay = Int32.Parse(Datearray[1]);
        month = Int32.Parse(Datearray[0]);
        year = Int32.Parse(Datearray[2]);

        from = DateTime.Now.ToShortDateString();
    }
    string showdate = daay.ToString() + '/' + month.ToString() + '/' + year.ToString();
    if (ViewBag.UserId != null)
    {
        UserId = ViewBag.UserId;
        //userName = _userManager.Users.Where(x => x.Id == UserId).FirstOrDefault().BUPFullName;
    }
    else
    {
        UserId = "95365f6d-0665-4630-a3ef-2b62642c8f40";
        //  userName = _userManager.Users.Where(x => x.Id == UserId).FirstOrDefault().BUPFullName;

    }

    DateTime t = DateTime.Now;

    var officeDict = new Dictionary<string, string>();
    var officeList = _context.Office.Where(x => x.Id > 0).ToList();

    foreach (var o in officeList)
    {
        officeDict.Add(o.Id.ToString(), o.Name);
    }


    var SetMenuList = new Dictionary<string, string>();
    var OnSpotList = new Dictionary<string, string>();

    var STMBrk = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 1).ToList();
    var STMLnch = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 2).ToList();
    var STMTBreak = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 3).ToList();

    var OnSpotItemList = _db.MenuItem.Where(x => x.Day == day).ToList();
    foreach (var i in OnSpotItemList)
    {
        var ext = _db.ExtraItem.Where(x => x.Id == i.ExtraItemId).FirstOrDefault();
        var storeOutItem = _db.StoreOutItem.Where(x => x.Id == ext.StoreOutItemId).FirstOrDefault();
        OnSpotList.Add(i.ExtraItemId.ToString(), storeOutItem.Name);
    }
    int ib = 0;
    foreach (var i in STMBrk)
    {
        ib++;
        SetMenuList.Add(i.Id.ToString(), "[BF]SetMenu" + ib);
    }
    int il = 0;
    foreach (var i in STMLnch)
    {
        il++;
        SetMenuList.Add(i.Id.ToString(), "[Ln]SetMenu" + il);
    }
    int it = 0;

    foreach (var i in STMTBreak)
    {
        it++;
        SetMenuList.Add(i.Id.ToString(), "[TB]SetMenu" + it);
    }


    //   var user = await _userManager.GetUserAsync(User);
    // var SetMenuList = _db.PreOrderSchedule.Where(x => x.MealTypeId == mealId && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();



    //var allItemForTheDay = _db.ExtraItem.Where(x => x.MenuDate.ToShortDateString() == DateTime.Today.ToShortDateString()).Select(x => x.StoreOutItemId).Distinct().ToList();

    //var PreOrderSetMenuDetailListTeabreak = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Today.AddDays(-1).ToShortDateString() && x.MealTypeId == 3);

    //    var setmenu = _db.SetMenu.Where(x=>x.SetMenuDate.ToShortDateString() == DateTime.Today.ToShortDateString())
    //var BillOfUser = _db.OrderHistory.Where(x => x.UserId == user.Id);

    //DateTime ToDate = DateTime.Now.AddDays(20);
    //DateTime FromDate = DateTime.Now.AddDays(20);
    //Boolean DateCheck = false;
    ////IQueryable<OrderHistory> theInfo = Enumerable.Empty<OrderHistory>().AsQueryable();
    //var theInfo = _db.OrderHistory.Where(x => x.UserId == user.Id && x.OrderDate >= FromDate && x.OrderDate <= ToDate).ToList();

    //List<OrderHistory> theInfo = new List<OrderHistory>();


    //-------------------------New Version--------------------------------------------------
    var DistinConsumerListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).ToList();

    var DistinConsumerListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).ToList();


    var DistinConsumerListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).ToList();

    var DistinConsumerListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).ToList();



}


@*<head>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css" />
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
    </head>*@

<style>
    .list-group {
        max-height: 300px;
        margin-bottom: 10px;
        overflow: scroll;
        -webkit-overflow-scrolling: touch;
    }

    .text {
        padding-left: 20px;
    }

    .date {
        padding-left: 10px;
    }

    /*.btn {
        /*padding: 0px 0px;
        font-size: 12px;
        cursor: pointer;
        margin: 0;*/
    /*color: red;
    }*/

    /**/

    .meal {
        padding-left: 20px;
    }

    .qn {
        padding-left: 0px;
    }

    .bgg {
        /* The image used */
        background-image: url("https://www.tibits.co.uk/assets/images/8/Autumn%20table%20%287%29-80f4ecc9.jpg");
        /* Full height */
        height: 100%;
        width: 100%;
        padding-top: 0px;
        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
    }

    * {
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
    }

    body {
        font-family: 'Roboto', sans-serif;
        color: #546E7A;
    }

    .wrapper {
        max-width: 18rem;
        padding: 0 0.5rem;
        margin-left: auto;
        margin-right: auto;
        padding-top: 4rem;
    }

    input:focus {
        outline: none;
    }

    #ui-datepicker-div {
        display: none;
        background-color: #fff;
        box-shadow: 0 0.125rem 0.5rem rgba(0,0,0,0.1);
        margin-top: 0.25rem;
        border-radius: 0.5rem;
        padding: 0.5rem;
    }

    table {
        border-collapse: collapse;
        border-spacing: 0;
    }

    .ui-datepicker-calendar thead th {
        padding: 0.25rem 0;
        text-align: center;
        font-size: 0.75rem;
        font-weight: 400;
        color: #78909C;
    }

    .ui-datepicker-calendar tbody td {
        width: 2.5rem;
        text-align: center;
        padding: 0;
    }

        .ui-datepicker-calendar tbody td a {
            display: block;
            border-radius: 0.25rem;
            line-height: 2rem;
            transition: 0.3s all;
            color: #546E7A;
            font-size: 0.875rem;
            text-decoration: none;
        }

            .ui-datepicker-calendar tbody td a:hover {
                background-color: #E0F2F1;
            }

            .ui-datepicker-calendar tbody td a.ui-state-active {
                background-color: #009688;
                color: white;
            }

    .ui-datepicker-header a.ui-corner-all {
        cursor: pointer;
        position: absolute;
        top: 0;
        width: 2rem;
        height: 2rem;
        margin: 0.5rem;
        border-radius: 0.25rem;
        transition: 0.3s all;
    }

        .ui-datepicker-header a.ui-corner-all:hover {
            background-color: #ECEFF1;
        }

    .ui-datepicker-header a.ui-datepicker-prev {
        left: 0;
        background: url("~/assets/img/prev.png");
        background-repeat: no-repeat;
        background-size: 0.5rem;
        background-position: 50%;
        transform: rotate(180deg);
    }

    .ui-datepicker-header a.ui-datepicker-next {
        right: 0;
        background: url("~/assets/img/prev.png");
        background-repeat: no-repeat;
        background-size: 10px;
        background-position: 50%;
    }

    .ui-datepicker-header a > span {
        display: none;
    }

    .ui-datepicker-title {
        text-align: center;
        line-height: 2rem;
        margin-bottom: 0.25rem;
        font-size: 0.875rem;
        font-weight: 500;
        padding-bottom: 0.25rem;
    }

    .ui-datepicker-week-col {
        color: #78909C;
        font-weight: 400;
        font-size: 0.75rem;
    }

    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 5; /* Sit on top */
        padding-top: 100px;
        padding-left: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding-top: 20px;
        padding-left: 50px;
        border: 1px solid #888;
        width: 52%;
    }

    /* The Close Button */
    .close {
        color: black;
        /*float: right;*/
        font-size: 20px;
        font-weight: bold;
    }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
</style>
<br />
<br />

<div class="content">
    <div class="container-fluid">
        <div id="myModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
                <div class="card" style="margin-left:-20px;">
                    <div class="card-header card-header-tabs card-header-success" style="padding-top:5px;height:60px;">
                        <div class="row">
                            <div class="col-md-8">


                                <div class="nav-tabs-navigation">
                                    <div class="nav-tabs-wrapper">
                                        <ul class="nav nav-tabs" data-tabs="tabs">
                                            <li class="nav-item" style="margin-right:50px;">
                                                <a class="nav-link active" href="#party" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Party
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item" style="margin-left:30px;">
                                                <a class="nav-link" href="#official" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Official
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item" style="margin-left:30px;">
                                                <a class="nav-link" href="#billprint" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Bill Print
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>


                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">


                            </div>
                        </div>


                    </div>
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="party">

                                <div class="row">
                                    <div class="col-md-8">

                                    </div>
                                    <div class="col-md-4">
                                        <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="OpenPartyInput()" class="btn"><i class="fas fa-plus"></i>&nbsp;New Order</button>

                                    </div>

                                </div>

                                <div id="PartyDB" class="row">
                                    @{
                                        var spclParent = _context.SpecialMenuParent.Where(x => x.OrderDate >= DateTime.Now && x.MealTypeId == 10006).ToList();

                                        var specialMenu = _context.SpecialMenuOrder.Where(x => x.Id > 0).ToList();
                                        //                            var distinctPersonDateList = specialMenu
                                        //.GroupBy(m => new { m.UserId, m.OrderDate })
                                        //.Select(group => group.First())  // instead of First you can also apply your logic here what you want to take, for example an OrderBy
                                        //.ToList();

                                        <table class="table table-striped table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Date</th>

                                                    <th>Name</th>
                                                    <th>Item</th>
                                                    <th></th>


                                                </tr>
                                            </thead>
                                            <tbody>

                                                @foreach (var item in spclParent)
                                                {
                                                    var itemCheck = specialMenu.Where(x => x.SpecialMenuParentId == item.Id).ToList();
                                                    if (itemCheck.Count > 0)
                                                    {
                                                    <tr>
                                                        <td> 1 </td>
                                                        <td>
                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @item.OrderDate.ToString("dd/MM/yyyy")

                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>


                                                        </td>
                                                        <td>

                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @*@_userManager.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPFullName*@


                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>

                                                        </td>
                                                        <td>
                                                            @foreach (var i in specialMenu)
                                                            {
                                                                if (item.Id == i.SpecialMenuParentId)
                                                                {
                                                                    <div class="row">
                                                                        <div class="col-sm-6">
                                                                            @_context.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault().Name

                                                                        </div>
                                                                        <div class="col-sm-2">
                                                                            @i.UnitOrdered
                                                                        </div>
                                                                        <div class="col-sm-2">
                                                                            <button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(@i.Id)" class="btn"><i class="fas fa-edit"></i></button>

                                                                        </div>

                                                                        <div class="col-sm-2">
                                                                            <button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(@i.Id)" class="btn"><i class="fas fa-trash"></i></button>

                                                                        </div>
                                                                    </div>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            <button onclick="SpecialTempPrint(@item.Id)" class="btn btn-white btn-round btn-just-icon">
                                                                <i class="material-icons">print</i>
                                                                <div class="ripple-container"></div>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    }

                                                }
                                            </tbody>
                                        </table>

                                    }



                                </div>

                                <div id="PartyEditOption">



                                </div>

                                <div id="PartyDateEditOption">


                                </div>
                                <div id="PartyPersonEditOption">

                                </div>
                                <div id="AfterPartyEdit">

                                </div>
                                <div id="AfterPartyDateEdit">

                                </div>
                                <div id="AfterPartyNameEdit">

                                </div>

                                <div id="AfterPartyDelete">

                                </div>

                                <div id="AfterBack">

                                </div>

                                <div id="PartyInput">
                                    <div class="row">
                                        <div class="col-md-6">

                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Person</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">person</i>
                                                    <input type="text" name="partyperson" id="partyperson" class="form-control" value="" />
                                                </div>
                                                <div id="partypersonbox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div style="display:inline-flex">
                                                <i class="material-icons" style="padding-top:5px;">calendar_today</i>
                                                <input type="text" name="partydate" id="partydate" class="form-control" value="" />
                                            </div>

                                        </div>





                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Item</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">local_dining</i>
                                                    <input type="text" name="partyitem" id="partyitem" class="form-control" value="" />


                                                </div>
                                                <div id="partyitembox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">

                                            <input type="number" name="piq" id="piq" class="form-control" placeholder="quantity" />

                                        </div>

                                        <div id="PriceDiv" class="col-md-2" style="display:none;">

                                            <input type="number" name="pr" id="pr" class="form-control" placeholder="price" />

                                        </div>

                                        <div class="col-md-1">
                                            @*<a href="#" onclick="AddPartyItem()"><i class="far fa-plus"></i></a>*@

                                            <button type="button" style="padding:5px;" rel="tooltip" onclick="AddPartyItem()" class="btn"><i class="fas fa-plus"></i></button>



                                        </div>





                                    </div>

                                    <br />
                                    <div class="row">
                                        <div class="col-md-9"></div><div class="col-md-3">
                                            <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseParty()" class="btn">Back</button>
                                        </div>
                                    </div>
                                    <br />
                                    <div id="InputDetail">


                                    </div>

                                </div>




                            </div>
                            <div class="tab-pane" id="official">
                                @*<div class="col-md-6">
                                        Hello

                                    </div>
                                    <div class="col-md-6">

                                    </div>*@
                                <div class="row">
                                    <div class="col-md-8">

                                    </div>
                                    <div class="col-md-4">
                                        <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="OpenOfficeInput()" class="btn"><i class="fas fa-plus"></i>&nbsp;New Order</button>

                                    </div>

                                </div>

                                <div id="OfficeDB" class="row">
                                    @{
                                        var spclOffParent = _context.SpecialMenuParent.Where(x => x.OrderDate >= DateTime.Now && x.MealTypeId == 10007).ToList();

                                        var specialOffMenu = _context.SpecialMenuOrder.Where(x => x.Id > 0).ToList();
                                        //                            var distinctPersonDateList = specialMenu
                                        //.GroupBy(m => new { m.UserId, m.OrderDate })
                                        //.Select(group => group.First())  // instead of First you can also apply your logic here what you want to take, for example an OrderBy
                                        //.ToList();

                                        <table class="table table-striped table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Date</th>

                                                    <th>Name</th>
                                                    <th>ItemDetail</th>
                                                    <th></th>


                                                </tr>
                                            </thead>
                                            <tbody>

                                                @foreach (var item in spclOffParent)
                                                {
                                                    var offItemCheck = specialOffMenu.Where(x => x.SpecialMenuParentId == item.Id).ToList();
                                                    if (offItemCheck.Count > 0)
                                                    {
                                                    <tr>
                                                        <td> 1 </td>
                                                        <td>
                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @item.OrderDate.ToString("dd/MM/yyyy")


                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>




                                                        </td>
                                                        <td>

                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @_context.Office.Where(x => x.Id == item.OfficeId).FirstOrDefault().Name;

                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>

                                                        </td>

                                                        <td>
                                                            @foreach (var i in specialOffMenu)
                                                            {
                                                                if (item.Id == i.SpecialMenuParentId)
                                                                {
                                                                    <div class="row">
                                                                        <div class="col-sm-6">
                                                                            @_context.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault().Name

                                                                        </div>
                                                                        <div class="col-sm-2">
                                                                            @i.UnitOrdered
                                                                        </div>
                                                                        <div class="col-sm-2">
                                                                            <button type="button" style="padding:2px" rel="tooltip" onclick="EditOffice(@i.Id)" class="btn"><i class="fas fa-edit"></i></button>

                                                                        </div>

                                                                        <div class="col-sm-2">
                                                                            <button type="button" style="padding:2px" rel="tooltip" onclick="DeleteOffice(@i.Id)" class="btn"><i class="fas fa-trash"></i></button>

                                                                        </div>
                                                                    </div>
                                                                }
                                                            }
                                                        </td>
                                                        <td>
                                                            <button onclick="SpecialTempPrint(@item.Id)" class="btn btn-white btn-round btn-just-icon">
                                                                <i class="material-icons">print</i>
                                                                <div class="ripple-container"></div>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    }

                                                }
                                            </tbody>
                                        </table>

                                    }



                                </div>

                                <div id="OfficeInput">
                                    <div class="row">
                                        <div class="col-md-4">

                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Person</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">person</i>
                                                    <input type="text" name="officeperson" id="officeperson" class="form-control" value="" />
                                                </div>
                                                <div id="officepersonbox"></div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">

                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Person</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">house</i>
                                                    <input type="text" name="officename" id="officename" class="form-control" value="" />
                                                </div>
                                                <div id="officebox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div style="display:inline-flex">
                                                <i class="material-icons" style="padding-top:5px;">calendar_today</i>
                                                <input type="text" name="officedate" id="officedate" class="form-control" value="" />
                                            </div>

                                        </div>





                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Item</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">local_dining</i>
                                                    <input type="text" name="officeitem" id="officeitem" class="form-control" value="" />


                                                </div>
                                                <div id="officeitembox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">

                                            <input type="number" name="oiq" id="oiq" class="form-control" placeholder="quantity" />

                                        </div>

                                        <div id="OffPriceDiv" class="col-md-2" style="display:none;">

                                            <input type="number" name="offpr" id="offpr" class="form-control" placeholder="price" />

                                        </div>

                                        <div class="col-md-1">
                                            @*<a href="#" onclick="AddOfficeItem()"><i class="far fa-plus"></i></a>*@

                                            <button type="button" style="padding:5px;" rel="tooltip" onclick="AddOfficeItem()" class="btn"><i class="fas fa-plus"></i></button>



                                        </div>





                                    </div>


                                    <div class="row">
                                        <div class="col-md-9"></div><div class="col-md-3">
                                            <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseOffice()" class="btn">Back</button>
                                        </div>
                                    </div>

                                    <div id="OfficeInputDetail">


                                    </div>
                                </div>



                                <div id="OfficeEditOption">

                                </div>

                                <div id="OfficeDateEditOption">


                                </div>
                                <div id="OfficeNameEditOption">

                                </div>
                                <div id="AfterOfficeEdit">

                                </div>
                                <div id="AfterOfficeDateEdit">

                                </div>
                                <div id="AfterOfficeNameEdit">

                                </div>

                                <div id="AfterOfficeDelete">

                                </div>

                                <div id="AfterOfficeBack">

                                </div>





                            </div>

                            <div class="tab-pane" id="billprint">

                                <div class="row">
                                    <div class="col-sm-6">

                                    </div>
                                    <div class="col-sm-4">
                                        <input type="text" name="billdate" id="billdate" class="form-control" value="" />

                                    </div>
                                    <div class="col-sm-2">
                                        <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="GetSpecialOnDate()" class="btn">Load</button>

                                    </div>
                                </div>


                                <div id="SpecialPrintDB" class="row">
                                    @{
                                        var speclParent = _context.SpecialMenuParent.Where(x => x.OrderDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString()).ToList();

                                        var specialMenuAll = _context.SpecialMenuOrder.Where(x => x.Id > 0).ToList();
                                        var sl = 0;
                                        //                            var distinctPersonDateList = specialMenu
                                        //.GroupBy(m => new { m.UserId, m.OrderDate })
                                        //.Select(group => group.First())  // instead of First you can also apply your logic here what you want to take, for example an OrderBy
                                        //.ToList();

                                        <table class="table table-striped table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Date</th>

                                                    <th>Name</th>
                                                    <th>ItemDetail</th>
                                                    <th></th>


                                                </tr>
                                            </thead>
                                            <tbody>

                                                @foreach (var item in speclParent)
                                                {
                                                    @*@sl= sl + 1;*@
                                                    <tr>
                                                        <td> @sl </td>
                                                        <td>
                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @item.OrderDate.ToShortDateString()

                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:5px;" rel="tooltip" onclick="EditPartyDate(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>


                                                        </td>
                                                        <td>

                                                            <div class="row">
                                                                <div class="col-sm-8">
                                                                    @*@_userManager.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPFullName*@


                                                                </div>
                                                                <div class="col-sm-4">
                                                                    <button type="button" style="padding:5px;" rel="tooltip" onclick="EditPartyName(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                                </div>

                                                            </div>

                                                        </td>
                                                        <td>
                                                            @foreach (var i in specialMenuAll)
                                                            {
                                                                if (item.Id == i.SpecialMenuParentId)
                                                                {
                                                                    <div class="row">
                                                                        <div class="col-sm-8">
                                                                            @_context.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault().Name

                                                                        </div>
                                                                        <div class="col-sm-4">
                                                                            @i.UnitOrdered
                                                                        </div>

                                                                    </div>
                                                                }
                                                            }
                                                        </td>

                                                        <td>

                                                            <button onclick="SpecialPrint(@item.Id)" class="btn btn-white btn-round btn-just-icon">
                                                                <i class="material-icons">print</i>
                                                                <div class="ripple-container"></div>
                                                            </button>
                                                        </td>
                                                    </tr>

                                                }
                                            </tbody>
                                        </table>

                                    }



                                </div>

                                <div id="SpecialOnDate">



                                </div>

                            </div>

                        </div>
                    </div>





                </div>




            </div>

        </div>
        <div class="modal fade" id="fileUploadModal" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title">Add Comment</h4>
                    </div>
                    <div class="modal-body">
                        <textarea id="commentsUpload" class="form-control custom-control" rows="3"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" onclick="submitXYX()" data-dismiss="modal">Submit</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-warning card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">content_copy</i>
                        </div>
                        <p class="card-category">Breakfast</p>
                        @{
                            double OnOffSetMenuBrk = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuBrk = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 1 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuBrk = OnOffSetMenuBrk + ExtSetMenuBrk;
                        }
                        <h3 class="card-title">
                            @TtlSetMenuBrk
                            <small>pcs</small>
                        </h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons text-danger">warning</i>
                            <a href="#pablo">Unserved @TtlSetMenuBrk pcs</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-success card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">store</i>
                        </div>
                        <p class="card-category">Lunch</p>
                        @{
                            double OnOffSetMenuLnch = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 2).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuLnch = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 2 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuLnch = OnOffSetMenuLnch + ExtSetMenuLnch;
                        }
                        <h3 class="card-title">
                            @TtlSetMenuLnch
                            <small>pcs</small>
                        </h3>

                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">date_range</i>Unserved  @TtlSetMenuLnch pcs
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-danger card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">info_outline</i>
                        </div>

                        <p class="card-category">TeaBreak</p>
                        @{
                            double OnOffSetMenuTBrk = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 3).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuTBrk = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 3 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuTBrk = OnOffSetMenuTBrk + ExtSetMenuTBrk;
                        }
                        <h3 class="card-title">
                            @TtlSetMenuTBrk
                            <small>pcs</small>
                        </h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">date_range</i>Unserved  @TtlSetMenuTBrk pcs
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon">
                            <i class="fa fa-clock"></i>
                        </div>
                        <p class="card-category">Last Order Time</p>
                        @*<div class="input-group clockpicker" style="width: 50%; float: left;">
                            <i class="material-icons">clock</i>*@
                        <input id="input-a" type="text" value="2:00" class="form-control clockpicker">

                        @*<input type="time" id="Time" class="form-control clockpicker" value="2 p.m.">*@
                        @*<span class="input-group-addon">
                                <span class="glyphicon glyphicon-time"></span>
                            </span>*@
                        @*</div>*@
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">update</i> Can Be Changed
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card card-chart">
                    <div class="card-header card-header-success">
                        <h5 style="font-weight:bold">On Spot Order</h5>
                        @*<div class="ct-chart" id="dailySalesChart"></div>*@
                    </div>
                    <div class="card-body">
                        <form asp-action="OnSpotOrderCreate" asp-route-userid="@UserId" asp-controller="AdminShowOrder" method="post">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Person</label>
                                        <div style="display:inline-flex">
                                            <i class="material-icons" style="padding-top:5px;">person</i>
                                            <input type="text" name="searchInput" id="searchInput" class="form-control" value="" />
                                        </div>
                                        <div id="suggesstion-box"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Meal</label>
                                        <br />
                                        <div style="display:inline-flex">
                                            <i class="material-icons" style="padding-top:8px;">list</i>
                                            @{
                                                var mt = _db.MealType.Where(x => x.Id == 1).FirstOrDefault();

                                            }
                                            <select id="meal" name="meal" class="form-control border-radius-none" asp-items="@(new SelectList(_ddlHelper.GetMealType().Prepend(new KeyValuePair<string, string>(@mt.Id.ToString(),@mt.Name)), "Key", "Value", ""))"></select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Item</label>
                                        <br />
                                        <div style="display:inline-flex">

                                            <i class="material-icons" style="padding-top:6px;">local_dining</i>
                                            <select id="onspotItem" name="onspotItem" class="form-control border-radius-none" asp-items="@(new SelectList(OnSpotList.Prepend(new KeyValuePair<string, string>("-1", "")), "Key", "Value", ""))"></select>

                                            @*<input type="text" name="searchInput2" id="searchInput2" class="form-control" value="" />
                                                </div>
                                                <div id="suggesstion-box2"></div>*@
                                        </div>


                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Quantity</label>
                                        <div style="display:inline-flex">
                                            <i class="material-icons" style="padding-top:6px;">double_arrow</i>
                                            <input type="text" id="itmQ" name="itmQ" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">SetMenu</label>
                                        <br />
                                        <div style="display:inline-flex">
                                            <i class="material-icons" style="padding-top:7px;">restaurant</i>
                                            <select id="setmenu" name="setmenu" class="form-control border-radius-none" asp-items="@(new SelectList(SetMenuList.Prepend(new KeyValuePair<string, string>("-1", "")), "Key", "Value", ""))"></select>

                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Quantity</label>
                                        <div style="display:inline-flex">
                                            <i class="material-icons" style="padding-top:6px;">double_arrow</i>
                                            <input type="text" name="stmQ" id="stmQ" class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-8">

                                </div>
                                <div class="col-md-4">
                                    <button type="submit" rel="tooltip" class="btn"><i class="fas fa-plus"></i><i class="material-icons">shopping_cart</i></button>

                                </div>
                            </div>
                        </form>
                    </div>
                    @*<div class="card-footer">
                            <div class="stats">
                                <i class="material-icons">access_time</i> updated 4 minutes ago
                            </div>
                        </div>*@
                </div>
            </div>
            <div class="col-lg-8 col-md-6 col-sm-6">
                <div class="card">
                    <div class="card-header card-header-tabs card-header-success" style="padding-top:5px;height:60px;">
                        <div class="row">
                            <div class="col-md-8">


                                <div class="nav-tabs-navigation">
                                    <div class="nav-tabs-wrapper">
                                        <span class="nav-tabs-title">Meal:</span>
                                        <ul class="nav nav-tabs" data-tabs="tabs">
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 1 ? "nav-link active" : "nav-link")" href="#breakfast" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Breakfast
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 3 ? "nav-link active" : "nav-link")" href="#teabreak" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> TeaBreak
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 2 ? "nav-link active" : "nav-link")" href="#lunch" data-toggle="tab">
                                                    <i class="material-icons">cloud</i> Lunch
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 10005 ? "nav-link active" : "nav-link")" href="#EC" data-toggle="tab">
                                                    <i class="material-icons">cloud</i> ExtraChit
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <form asp-action="FetchOrderDate" asp-controller="AdminShowOrder" method="post">
                                    <div class="input-group no-border">

                                        <input type="text" id="datepicker" name="datepicker" value="@showdate" class="form-control col-sm-8" placeholder="Search...">
                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                            <i class="material-icons">search</i>
                                            <div class="ripple-container"></div>
                                        </button>
                                    </div>

                                </form>

                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="@(lastUpdate == 1 ? "tab-pane active" : "tab-pane")" id="breakfast">
                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect == 1 ? "nav-link active" : "nav-link")" href="#BP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect == 2 ? "nav-link active" : "nav-link")" href="#BI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect == 1 ? "tab-pane active" : "tab-pane")" id="BP">


                                        <div class="row">
                                            <div class="col-sm-6">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder" asp-action="FetchPersonOrder" asp-route-MealId="1" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person" name="person" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-2">

                                                <button onclick="Print('BreakfastPerson',800,700,'Breakfast',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="BreakfastPerson" style="padding-top:0px;">

                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 1)
                                                {
                                                    //var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                    //var pr = from p in PersonList
                                                    //         join o in DistinConsumerListBrk
                                                    //         on p.Id equals o
                                                    //         // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                    //         select o;
                                                    //var pList = pr.ToList();
                                                    //DistinConsumerListBrk = pList;
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                    //PreOrderSetMenuDetailList = pList;
                                                }
                                            }

                                            <table class="table list-group" style="padding-left:75px;">
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListBrk)
                                                    {
                                                        var ListOfItem = ConsumerDtlListBrk.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
.GroupBy(a => a.ExtraItemId)
.Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
.ToList();

                                                        //  var specificPersonChoiceList = ConsumerDtlListBrk.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                        <tr>
                                                            <td>@*@_userManager.Users.Where(x => x.Id == p).FirstOrDefault().BUPFullName;*@</td>
                                                            @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                            }

                                                            <td>@ItemDetail</td>


                                                        </tr>
                                                    }


                                                </tbody>
                                            </table>

                                        </div>

                                    </div>
                                    <div class="@(subMenuDetect== 2 ? "tab-pane active":"tab-pane")" id="BI">

                                        <div class="row">
                                            <div class="col-sm-6">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder" asp-action="FetchItemOrder" asp-route-MealId="1" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item" name="item" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-2">

                                                <button onclick="Print('BreakfastItem',800,700,'Breakfast',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>
                                            </div>
                                        </div>
                                        @{





                                            <div id="BreakfastItem" style="padding-top:0px;">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    @if (ViewBag.MealId != null)
                                                    {
                                                        if (lastUpdate == 1)
                                                        {
                                                            var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                            var or = from p in ItemList
                                                                     join o in _db.ExtraItem
                                                                      on p.Id equals o.StoreOutItemId
                                                                     where o.Day == day && o.MealTypeId == 1
                                                                     select o;
                                                            var di = from ro in or
                                                                     join dib in DistinItemListBrk
                                                                     on ro.Id equals dib
                                                                     select dib;

                                                            //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                            DistinItemListBrk = di.ToList();
                                                            //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        }
                                                    }

                                                    <tbody>
                                                        @foreach (var itm in DistinItemListBrk)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListBrk.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>

                                            </div>
                                        }


                                    </div>
                                </div>

                            </div>
                            <div class="@(lastUpdate == 3 ? "tab-pane active":"tab-pane")" id="teabreak">
                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect2 == 1 ? "nav-link active" : "nav-link")" href="#TP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect2 == 2 ? "nav-link active" : "nav-link")" href="#TI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>

                                <div class="tab-content">

                                    <div class="@(subMenuDetect2 == 1 ? "tab-pane active" : "tab-pane")" id="TP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder2" asp-action="FetchPersonOrder" asp-route-MealId="3" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person2" name="person2" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('TBreakPerson',800,700,'TeaBreak',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        <div id="TBreakPerson">
                                            <table class="table list-group" style="padding-left:75px;">


                                                @*@if (ViewBag.MealId != null)
                                                    {
                                                        if (lastUpdate == 1)
                                                        {
                                                            var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                            var pr = from p in PersonList
                                                                     join o in DistinConsumerListBrk
                                                                     on p.Id equals o
                                                                     // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                                     select o;
                                                            var pList = pr.ToList();
                                                            DistinConsumerListBrk = pList;
                                                            //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                            //PreOrderSetMenuDetailList = pList;
                                                        }
                                                    }*@
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 3)
                                                    {
                                                        //var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                        //var pr = from p in PersonList
                                                        //         join o in DistinConsumerListTBrk
                                                        //         on p.Id equals o
                                                        //         // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                        //         select o;
                                                        //var pList = pr.ToList();
                                                        //DistinConsumerListTBrk = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListTBrk)
                                                    {

                                                        var ListOfItem = ConsumerDtlListTBrk.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                        .GroupBy(a => a.ExtraItemId)
                                                        .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                        .ToList();
                                                        //var specificPersonChoiceList = ConsumerDtlListTBrk.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                        <tr>
                                                            <td>@*@_userManager.Users.Where(x => x.Id == p).FirstOrDefault().BUPFullName;*@</td>
                                                            @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                            }

                                                            <td>@ItemDetail</td>


                                                        </tr>
                                                    }


                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                    <div class="@(subMenuDetect2== 2 ? "tab-pane active":"tab-pane")" id="TI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder2" asp-action="FetchItemOrder" asp-route-MealId="3" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item2" name="item2" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('TBreakItem',800,700,'TeaBreak',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>


                                            </div>
                                        </div>
                                        @{


                                            subMenuDetect = 2;



                                            var PreOrderSetMenuDetailListItmTBrk = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 3).ToList();
                                            var ItemOrderHistoryOnDay2 = _db.OrderHistory.Where(x => x.MealTypeId == 3 && x.StoreOutItemId != null && x.OrderDate.ToShortDateString() == OrderDate).Select(x => x.StoreOutItemId).Distinct().ToList();

                                            var OrderHistoryOnDay2 = _db.OrderHistory.Where(x => x.MealTypeId == 3 && x.OrderDate.ToShortDateString() == OrderDate).ToList();
                                            //var SetMenuList = _db.PreOrderSchedule.Where(x => x.MealTypeId == 1 && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 3)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    var or = from p in ItemList
                                                             join o in _db.ExtraItem
                                                              on p.Id equals o.StoreOutItemId
                                                             where o.Day == day && o.MealTypeId == 3
                                                             select o;
                                                    var di = from ro in or
                                                             join dib in DistinItemListTBrk
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListTBrk = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }
                                            // var SetMenuListBF = _db.PreOrderSchedule.Where(x => x.MealTypeId == 1 && x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString()).ToList();

                                            var SetMenuListTB = _db.SetMenu.Where(x => x.MealTypeId == 3 && x.SetMenuDate.ToShortDateString() == OrderDate).ToList();

                                            //var OnOffMealList = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.MealTypeId == mealId && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();
                                            var OnOffMealListTB = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.MealTypeId == 3 && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString()).ToList();

                                            <div id="TBreakItem">

                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListTBrk)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListTBrk.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>
                                            </div>


                                        }


                                    </div>
                                </div>

                            </div>
                            <div class="@(lastUpdate == 2 ? "tab-pane active":"tab-pane")" id="lunch">

                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect3 == 1 ? "nav-link active" : "nav-link")" href="#LP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect3 == 2 ? "nav-link active" : "nav-link")" href="#LI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect3 == 1 ? "tab-pane active" : "tab-pane")" id="LP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder3" asp-action="FetchPersonOrder" asp-route-MealId="2" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person3" name="person3" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('LPerson',800,700,'Lunch',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>


                                            </div>
                                        </div>
                                        <div id="LPerson">
                                            <table class="table list-group" style="padding-left:75px;">
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 2)
                                                    {
                                                        //var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                        //var pr = from p in PersonList
                                                        //         join o in DistinConsumerListLnch
                                                        //         on p.Id equals o
                                                        //         // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                        //         select o;
                                                        //var pList = pr.ToList();
                                                        //DistinConsumerListLnch = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListLnch)
                                                    {

                                                        var ListOfItem = ConsumerDtlListLnch.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                    .GroupBy(a => a.ExtraItemId)
                                                    .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                    .ToList();
                                                        //  var specificPersonChoiceList = ConsumerDtlListLnch.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                        <tr>
                                                            <td>@*@_userManager.Users.Where(x => x.Id == p).FirstOrDefault().BUPFullName;*@</td>
                                                            @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                            }

                                                            <td>@ItemDetail</td>


                                                        </tr>
                                                    }


                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="@(subMenuDetect3 == 2 ? "tab-pane active":"tab-pane")" id="LI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder3" asp-action="FetchItemOrder" asp-route-MealId="2" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item3" name="item3" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('LItem',800,700,'Lunch',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        @{


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 2)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    var or = from p in ItemList
                                                             join o in _db.ExtraItem
                                                              on p.Id equals o.StoreOutItemId
                                                             where o.Day == day && o.MealTypeId == 2
                                                             select o;
                                                    var di = from ro in or
                                                             join dib in DistinItemListLnch
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListLnch = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }

                                            <div id="LItem">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListLnch)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListLnch.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>
                                            </div>


                                        }


                                    </div>





                                </div>
                            </div>
                            <div class="@(lastUpdate == 10005 ? "tab-pane active":"tab-pane")" id="EC">

                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect4 == 1 ? "nav-link active" : "nav-link")" href="#EP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect4 == 2 ? "nav-link active" : "nav-link")" href="#EI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect4 == 1 ? "tab-pane active" : "tab-pane")" id="EP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder4" asp-action="FetchPersonOrder" asp-route-MealId="10005" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person4" name="person4" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('ECPerson',800,700,'ExtraChit',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        <div id="ECPerson">
                                            <table class="table list-group" style="padding-left:75px;">
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 10005)
                                                    {
                                                        //var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                        //var pr = from p in PersonList
                                                        //         join o in DistinConsumerListEC
                                                        //         on p.Id equals o
                                                        //         // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                        //         select o;
                                                        //var pList = pr.ToList();
                                                        //DistinConsumerListEC = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListEC)
                                                    {
                                                        var ListOfItem = ConsumerDtlListEC.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                        .GroupBy(a => a.ExtraItemId)
                                                        .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                        .ToList();
                                                        // var specificPersonChoiceList = ConsumerDtlListEC.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                        <tr>
                                                            <td>@*@_userManager.Users.Where(x => x.Id == p).FirstOrDefault().BUPFullName;*@</td>
                                                            @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                            }

                                                            <td>@ItemDetail</td>


                                                        </tr>
                                                    }


                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="@(subMenuDetect4 == 2 ? "tab-pane active":"tab-pane")" id="EI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder4" asp-action="FetchItemOrder" asp-route-MealId="10005" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item4" name="item4" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('ECItem',800,700,'ExtraChit',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        @{


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 10005)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    var or = from p in ItemList
                                                             join o in _db.ExtraItem
                                                              on p.Id equals o.StoreOutItemId
                                                             //where o.Day == day && o.MealTypeId == 2
                                                             select o;
                                                    var di = from ro in or
                                                             join dib in DistinItemListEC
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListEC = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }
                                            <div id="ECItem">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListEC)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListEC.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>

                                            </div>


                                        }


                                    </div>





                                </div>
                            </div>
                        </div>
                    </div>


                </div>
                @*<div class="col-md-4">
                        <div class="card card-chart">
                            <div class="card-header card-header-warning">
                                <div class="ct-chart" id="websiteViewsChart"></div>
                            </div>
                            <div class="card-body">
                                <h4 class="card-title">Email Subscriptions</h4>
                                <p class="card-category">Last Campaign Performance</p>
                            </div>
                            <div class="card-footer">
                                <div class="stats">
                                    <i class="material-icons">access_time</i> campaign sent 2 days ago
                                </div>
                            </div>
                        </div>
                    </div>*@
                @*<div class="col-md-4">
                        <div class="card card-chart">
                            <div class="card-header card-header-danger">
                                <div class="ct-chart" id="completedTasksChart"></div>
                            </div>
                            <div class="card-body">
                                <h4 class="card-title">Completed Tasks</h4>
                                <p class="card-category">Last Campaign Performance</p>
                            </div>
                            <div class="card-footer">
                                <div class="stats">
                                    <i class="material-icons">access_time</i> campaign sent 2 days ago
                                </div>
                            </div>
                        </div>
                    </div>*@
            </div>
        </div>
    </div>
</div>
<div class="fixed-plugin">
    <div class="dropdown show-dropdown">
        <a href="#" onclick="OpenPartyModal()">
            <i class="fa fa-cog fa-2x"> </i>
        </a>


        <ul class="dropdown-menu" style="width:350px;">

            <li class="header-title"> Sidebar Filters</li>
            <li class="adjustments-line">
                <a href="javascript:void(0)" class="switch-trigger active-color">
                    <div class="badge-colors ml-auto mr-auto">
                        <span class="badge filter badge-purple" data-color="purple"></span>
                        <span class="badge filter badge-azure" data-color="azure"></span>
                        <span class="badge filter badge-green" data-color="green"></span>
                        <span class="badge filter badge-warning" data-color="orange"></span>
                        <span class="badge filter badge-danger" data-color="danger"></span>
                        <span class="badge filter badge-rose active" data-color="rose"></span>
                    </div>
                    <div class="clearfix"></div>
                </a>
            </li>
            <li class="header-title">Images</li>
            <li class="active">
                <a class="img-holder switch-trigger" href="javascript:void(0)">
                    <img src="../assets/img/sidebar-1.jpg" alt="">
                </a>
            </li>
            <li>
                <a class="img-holder switch-trigger" href="javascript:void(0)">
                    <img src="../assets/img/sidebar-2.jpg" alt="">
                </a>
            </li>
            <li>
                <a class="img-holder switch-trigger" href="javascript:void(0)">
                    <img src="../assets/img/sidebar-3.jpg" alt="">
                </a>
            </li>
            <li>
                <a class="img-holder switch-trigger" href="javascript:void(0)">
                    <img src="../assets/img/sidebar-4.jpg" alt="">
                </a>
            </li>
            <li class="button-container">
                <a href="https://www.creative-tim.com/product/material-dashboard" target="_blank" class="btn btn-primary btn-block">Free Download</a>
            </li>
            <!-- <li class="header-title">Want more components?</li>
            <li class="button-container">
                <a href="https://www.creative-tim.com/product/material-dashboard-pro" target="_blank" class="btn btn-warning btn-block">
                  Get the pro version
                </a>
            </li> -->
            <li class="button-container">
                <a href="https://demos.creative-tim.com/material-dashboard/docs/2.1/getting-started/introduction.html" target="_blank" class="btn btn-default btn-block">
                    View Documentation
                </a>
            </li>
            <li class="button-container github-star">
                <a class="github-button" href="https://github.com/creativetimofficial/material-dashboard" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star ntkme/github-buttons on GitHub">Star</a>
            </li>
            <li class="header-title">Thank you for 95 shares!</li>
            <li class="button-container text-center">
                <button id="twitter" class="btn btn-round btn-twitter"><i class="fa fa-twitter"></i> &middot; 45</button>
                <button id="facebook" class="btn btn-round btn-facebook"><i class="fa fa-facebook-f"></i> &middot; 50</button>
                <br>
                <br>
            </li>
            @*<div class="card">
                <div class="card-header card-header-tabs card-header-success" style="padding-top:5px;height:60px;">
                    <div class="row">
                        <div class="col-md-8">


                            <div class="nav-tabs-navigation">
                                <div class="nav-tabs-wrapper">
                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                        <li class="nav-item" style="margin-right:50px;">
                                            <a class="nav-link active"  href="#party" data-toggle="tab">
                                                <i class="material-icons">bug_report</i> Party
                                                <div class="ripple-container"></div>
                                            </a>
                                        </li>
                                        <li class="nav-item" style="margin-left:30px;">
                                            <a class= "nav-link" href="#official" data-toggle="tab">
                                                <i class="material-icons">bug_report</i> Official
                                                <div class="ripple-container"></div>
                                            </a>
                                        </li>


                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">


                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="tab-content">
                        <div class="tab-pane active" id="party">
                            <div class="col-md-6">
                                Hello

                            </div>
                            <div class="col-md-6">

                            </div>



                        </div>
                        <div class="tab-pane" id="">
                            <div class="col-md-6">
                                Hello

                            </div>
                            <div class="col-md-6">

                            </div>



                        </div>
                    </div>
                        </div>





                        </div>*@
        </ul>

    </div>

</div>



<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css" />
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
<script src="~\JavaScripts\DashboardController.js"></script>
@*<script type="text/javascript" src="~/assets/js/Jquery.min.js"></script>
    <script type="text/javascript" src="~/assets/js/jquery-ui.min.js"></script>*@


@*<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.min.js"
            asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
            asp-fallback-test="window.jQuery"
            crossorigin="anonymous"
            integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT">
    </script>*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>*@










@*@section Scripts {




    
}*@


