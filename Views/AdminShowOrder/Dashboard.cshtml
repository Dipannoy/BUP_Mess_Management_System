@inject ApplicationDbContext _context
@inject Microsoft.AspNetCore.Identity.UserManager<ApplicationUser> _userManager
@inject ApplicationDbContext _db
@inject IDDLHelper _ddlHelper

@inject IDDLHelper _ddlhelper
@{

    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    var from = this.Context.Request.Query["from"];
    var person = this.Context.Request.Query["searchInput"];
    int day = 0;
    string userName = "";
    string itemNamePartial = "";
    string personNamePartial = "";
    int daay = 0;
    int month = 0;
    int year = 0;



    string OrderDate = "";
    DateTime OD = DateTime.Now;
    int lastUpdate = 1;
    int subMenuDetect = 1;
    int subMenuDetect2 = 1;
    int subMenuDetect3 = 1;
    int subMenuDetect4 = 1;


    //OrderDate = DateTime.Now.ToShortDateString();
    string UserId = "";
    if (ViewBag.submenu != null)
    {

        lastUpdate = ViewBag.submenu;
    }
    if (ViewBag.person != null)
    {
        personNamePartial = ViewBag.person;
    }
    if (ViewBag.item != null)
    {
        itemNamePartial = ViewBag.item;
    }
    if (ViewBag.MealId != null)
    {
        lastUpdate = ViewBag.MealId;
    }
    if (ViewBag.SubMenuId != null)
    {
        if (lastUpdate == 1)
        {
            subMenuDetect = ViewBag.SubMenuId;
        }
        else if (lastUpdate == 3)
        {
            subMenuDetect2 = ViewBag.SubMenuId;
        }
        else if (lastUpdate == 2)
        {
            subMenuDetect3 = ViewBag.SubMenuId;
        }
        else
        {
            subMenuDetect4 = ViewBag.SubMenuId;

        }
    }
    if (ViewBag.OrderDate != null)
    {
        day = (int)ViewBag.OrderDate.DayOfWeek + 1;

        OrderDate = ViewBag.OrderDate.ToShortDateString();
        OD = ViewBag.OrderDate;
        string[] Datearray = OrderDate.Split("/");
        daay = Int32.Parse(Datearray[1]);
        month = Int32.Parse(Datearray[0]);
        year = Int32.Parse(Datearray[2]);
    }
    else
    {
        day = (int)DateTime.Today.DayOfWeek + 1;
        OrderDate = DateTime.Now.ToShortDateString();
        string[] Datearray = OrderDate.Split("/");
        daay = Int32.Parse(Datearray[1]);
        month = Int32.Parse(Datearray[0]);
        year = Int32.Parse(Datearray[2]);

        from = DateTime.Now.ToShortDateString();
    }
    string showdate = daay.ToString() + '/' + month.ToString() + '/' + year.ToString();
    if (ViewBag.UserId != null)
    {
        UserId = ViewBag.UserId;
        userName = _userManager.Users.Where(x => x.Id == UserId).FirstOrDefault().BUPFullName;
    }
    else
    {
        UserId = "95365f6d-0665-4630-a3ef-2b62642c8f40";
        userName = _userManager.Users.Where(x => x.Id == UserId).FirstOrDefault().BUPFullName;

    }

    DateTime t = DateTime.Now;

    var officeDict = new Dictionary<string, string>();
    var officeList = _context.Office.Where(x => x.Id > 0).ToList();

    foreach (var o in officeList)
    {
        officeDict.Add(o.Id.ToString(), o.Name);
    }


    var SetMenuList = new Dictionary<string, string>();
    var OnSpotList = new Dictionary<string, string>();
    var brkTotalItemDict = new Dictionary<string, string>();
    var lnTotalItemDict = new Dictionary<string, string>();
    var tbrkTotalItemDict = new Dictionary<string, string>();
    var echitTotalItemDict = new Dictionary<string, string>();

    var STMBrk = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 1).ToList();
    var STMLnch = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 2).ToList();
    var STMTBreak = _db.SetMenu.Where(x => x.SetMenuDate.ToShortDateString() == DateTime.Now.ToShortDateString() && x.MealTypeId == 3).ToList();

    var lastTime = _db.Constants.Where(x => x.Name == "Last Time").FirstOrDefault();
    var OnSpotItemList = _db.DailyOfferItem.Where(x => x.Date.Date == DateTime.Now.Date || x.IsActive == true).ToList();
    foreach (var i in OnSpotItemList)
    {
        var itemCount = _context.CustomerChoiceV2.Where(x => x.Date.Date == DateTime.Now.Date && x.OrderTypeId == 10002
        && x.MealTypeId == 10005 && x.StoreOutItemId == i.StoreOutItemId).Sum(x => x.quantity);
        //if (itemCount < i.OrderLimit)
        //{
        var availableAmount = i.OrderLimit - itemCount;

        var storeOutItem = _db.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault();
        OnSpotList.Add(i.StoreOutItemId.ToString(), storeOutItem.Name + "[" + availableAmount.ToString() + "pcs available]");
        //}
    }
    int ib = 0;
    foreach (var i in STMBrk)
    {
        ib++;
        SetMenuList.Add(i.Id.ToString(), "[BF]SetMenu" + ib);
    }
    int il = 0;
    foreach (var i in STMLnch)
    {
        il++;
        SetMenuList.Add(i.Id.ToString(), "[Ln]SetMenu" + il);
    }
    int it = 0;

    foreach (var i in STMTBreak)
    {
        it++;
        SetMenuList.Add(i.Id.ToString(), "[TB]SetMenu" + it);
    }


    var user = await _userManager.GetUserAsync(User);






    // var SetMenuList = _db.PreOrderSchedule.Where(x => x.MealTypeId == mealId && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();



    //var allItemForTheDay = _db.ExtraItem.Where(x => x.MenuDate.ToShortDateString() == DateTime.Today.ToShortDateString()).Select(x => x.StoreOutItemId).Distinct().ToList();

    //var PreOrderSetMenuDetailListTeabreak = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Today.AddDays(-1).ToShortDateString() && x.MealTypeId == 3);

    //    var setmenu = _db.SetMenu.Where(x=>x.SetMenuDate.ToShortDateString() == DateTime.Today.ToShortDateString())
    //var BillOfUser = _db.OrderHistory.Where(x => x.UserId == user.Id);

    //DateTime ToDate = DateTime.Now.AddDays(20);
    //DateTime FromDate = DateTime.Now.AddDays(20);
    //Boolean DateCheck = false;
    ////IQueryable<OrderHistory> theInfo = Enumerable.Empty<OrderHistory>().AsQueryable();
    //var theInfo = _db.OrderHistory.Where(x => x.UserId == user.Id && x.OrderDate >= FromDate && x.OrderDate <= ToDate).ToList();

    //List<OrderHistory> theInfo = new List<OrderHistory>();

    var onSpotOrderList = _context.OnSpotParent.Where(x => x.Date.Date == DateTime.Now.Date).OrderByDescending(x=>x.Id).ToList();



    //-------------------------New Version--------------------------------------------------
    var DistinConsumerListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).OrderBy(x => x.Date.TimeOfDay).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 1 && x.Date.ToShortDateString() == OrderDate).ToList();

    var DistinConsumerListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).OrderBy(x => x.Date).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListLnch = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 2 && x.Date.ToShortDateString() == OrderDate).ToList();


    var DistinConsumerListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).OrderBy(x => x.Date).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).Select(x => x.ExtraItemId).Distinct().ToList();
    var ConsumerDtlListTBrk = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 3 && x.Date.ToShortDateString() == OrderDate).ToList();

    var DistinConsumerListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).OrderBy(x => x.Date).Select(x => x.UserId).Distinct().ToList();
    var DistinItemListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).Select(x => x.StoreOutItemId).Distinct().ToList();
    var ConsumerDtlListEC = _db.CustomerChoiceV2.Where(x => x.MealTypeId == 10005 && x.Date.ToShortDateString() == OrderDate).ToList();


    //=============================================================================
    var preSheduleList = _context.PreOrderSchedule.Where(x => x.Id > 0).ToList();
    var dateParentList = _context.UserDateChoiceMaster.Where(x => x.Id > 0).ToList();
    var dateDetailList = _context.UserDateChoiceDetail.Where(x => x.Id > 0).ToList();

    var dateDBList = from dtParent in dateParentList
                     join dtDetail in dateDetailList
                     on dtParent.Id equals dtDetail.UserDateChoiceMasterId

                     where dtDetail.Date.ToShortDateString() == DateTime.Now.ToShortDateString()
                     select new { dtParent.UserId, dtParent.MealTypeId,dtDetail.Date, dtDetail.IsOrderSet};
    dateDBList = dateDBList.ToList();

    var modalList2 = from p in preSheduleList
                     join o in dateDBList
                     on new { A = p.UserId, B = p.MealTypeId } equals new { A = o.UserId, B = o.MealTypeId }
                     into tempO
                     from subSet in tempO.DefaultIfEmpty()

                     select new { p.UserId,p.IsPreOrderSet,p.MealTypeId,
                         Date = subSet == null ? DateTime.Now.Date : subSet.Date,
                         OrderSet = subSet == null ? false : subSet.IsOrderSet,
                         NoDate = subSet == null ? true : false
                     };
    modalList2 = modalList2.ToList();


    //var modalList2 = from p in modalList
    //                 join o in dateDetailList.Where(x=>x.Date.ToShortDateString() == DateTime.Now.ToShortDateString()).ToList()
    //                 on p.ParentId equals o.UserDateChoiceMasterId
    //                 into tempO

    //                 from subSet in tempO.DefaultIfEmpty()

    //                 select new {p,
    //                     Date = subSet == null ? DateTime.Now.Date:subSet.Date,
    //                     OrderSet = subSet == null ? false: subSet.IsOrderSet,
    //                     NoDate = subSet == null ? true : false};

    //modalList2 = modalList2.ToList();
    var brkModalList = modalList2.Where
        (x=>x.Date.Date == DateTime.Now.Date
        &&
        (x.OrderSet == true
        || (x.OrderSet == false && x.NoDate == true && x.IsPreOrderSet == true))
        && x.MealTypeId == 1).ToList();
    var tbrkModalList = modalList2.Where(x => x.Date.Date == DateTime.Now.Date && (x.OrderSet == true || (x.OrderSet == false && x.NoDate == true && x.IsPreOrderSet == true)) && x.MealTypeId == 3).ToList();
    var lnModalList = modalList2.Where(x => x.Date.Date == DateTime.Now.Date && (x.OrderSet == true || (x.OrderSet == false && x.NoDate == true && x.IsPreOrderSet == true)) && x.MealTypeId == 2).ToList();


    }
<head>
    @*<link rel="stylesheet" type="text/css" href="~/assets2/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="~/assets2/css/github.min.css">*@
    @*<link rel="stylesheet" type="text/css" href="~/dist2/bootstrap-clockpicker.min.css">*@
    @*<link type="text/css" href="https://daemonite.github.io/material/css/material.min.css">
        <link type="text/css" href="https://daemonite.github.io/material/js/material.min.js">
        <link type="text/css" href="https://cdn.jsdelivr.net/gh/djibe/clockpicker@1d03466e3b5eebc9e7e1dc4afa47ff0d265e2f16/dist/bootstrap4-clockpicker.min.css">


        <link type="text/css" href="https://cdn.jsdelivr.net/gh/djibe/clockpicker@6d385d49ed6cc7f58a0b23db3477f236e4c1cd3e/dist/bootstrap4-clockpicker.min.js">*@
    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>*@
    @*<script src="https://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.js"></script>
        <link href="https://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.css" rel="stylesheet" />*@
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <link href="~/assets/css/material-dashboard.css?v=2.1.1" rel="stylesheet" />
    <link href="~/assets/demo/demo.css" rel="stylesheet" />


</head>

@*<head>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css" />
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
    </head>*@

<style>
    .list-group {
        max-height: 300px;
        margin-bottom: 10px;
        overflow: scroll;
        -webkit-overflow-scrolling: touch;
    }

    .text {
        padding-left: 20px;
    }
    .selectStl {
        margin-top: 35px;
    }
    .checkStl {
        margin-top: 35px;
    }
      .labelStl {
        margin-top: 35px;
    }
    .date {
        padding-left: 10px;
    }

    .onSpotHead{
        font-weight:bold;
        color:darkorange;
    }
    /*.btn {
        /*padding: 0px 0px;
        font-size: 12px;
        cursor: pointer;
        margin: 0;*/
    /*color: red;
    }*/
    /**/
    .meal {
        padding-left: 20px;
    }

    .qn {
        padding-left: 0px;
    }

    .bgg {
        /* The image used */
        background-image: url("https://www.tibits.co.uk/assets/images/8/Autumn%20table%20%287%29-80f4ecc9.jpg");
        /* Full height */
        height: 100%;
        width: 100%;
        padding-top: 0px;
        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
    }

    * {
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
    }

    body {
        font-family: 'Roboto', sans-serif;
        color: #546E7A;
    }

    .wrapper {
        max-width: 18rem;
        padding: 0 0.5rem;
        margin-left: auto;
        margin-right: auto;
        padding-top: 4rem;
    }

    input:focus {
        outline: none;
    }

    #ui-datepicker-div {
        display: none;
        background-color: #fff;
        box-shadow: 0 0.125rem 0.5rem rgba(0,0,0,0.1);
        margin-top: 0.25rem;
        border-radius: 0.5rem;
        padding: 0.5rem;
    }

    table {
        border-collapse: collapse;
        border-spacing: 0;
    }

    .ui-datepicker-calendar thead th {
        padding: 0.25rem 0;
        text-align: center;
        font-size: 0.75rem;
        font-weight: 400;
        color: #78909C;
    }

    .ui-datepicker-calendar tbody td {
        width: 2.5rem;
        text-align: center;
        padding: 0;
    }

        .ui-datepicker-calendar tbody td a {
            display: block;
            border-radius: 0.25rem;
            line-height: 2rem;
            transition: 0.3s all;
            color: #546E7A;
            font-size: 0.875rem;
            text-decoration: none;
        }

            .ui-datepicker-calendar tbody td a:hover {
                background-color: #E0F2F1;
            }

            .ui-datepicker-calendar tbody td a.ui-state-active {
                background-color: #009688;
                color: white;
            }

    .ui-datepicker-header a.ui-corner-all {
        cursor: pointer;
        position: absolute;
        top: 0;
        width: 2rem;
        height: 2rem;
        margin: 0.5rem;
        border-radius: 0.25rem;
        transition: 0.3s all;
    }

        .ui-datepicker-header a.ui-corner-all:hover {
            background-color: #ECEFF1;
        }

    .ui-datepicker-header a.ui-datepicker-prev {
        left: 0;
        background: url("~/assets/img/prev.png");
        background-repeat: no-repeat;
        background-size: 0.5rem;
        background-position: 50%;
        transform: rotate(180deg);
    }

    .ui-datepicker-header a.ui-datepicker-next {
        right: 0;
        background: url("~/assets/img/prev.png");
        background-repeat: no-repeat;
        background-size: 10px;
        background-position: 50%;
    }

    .ui-datepicker-header a > span {
        display: none;
    }

    .ui-datepicker-title {
        text-align: center;
        line-height: 2rem;
        margin-bottom: 0.25rem;
        font-size: 0.875rem;
        font-weight: 500;
        padding-bottom: 0.25rem;
    }

    .ui-datepicker-week-col {
        color: #78909C;
        font-weight: 400;
        font-size: 0.75rem;
    }

    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 5; /* Sit on top */
        padding-top: 100px;
        padding-left: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding-top: 20px;
        padding-left: 50px;
        border: 1px solid #888;
        width: 40%;
    }

    /* The Close Button */
    .close {
        color: black;
        /*float: right;*/
        font-size: 20px;
        font-weight: bold;
    }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
</style>
<br />
<br />
<div class="content">
    <div class="container-fluid">
        <div id="onSpotEdit" class="modal">
            <div class="modal-content">
                <div class="row">

                    <div class="col-sm-3" id="removeLabel">

                    </div>
                    <div class="col-sm-1" id="removeCheck">

                    </div>
                    <div class="col-sm-3" id="itemFld">

                    </div>
                    <div class="col-sm-3" id="itemQntFld">

                    </div>
                    <div class="col-sm-2" id="itemQntFld">

                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">

                    </div>

                    <div class="col-sm-4" id="moreItemDropEdit">

                    </div>
                    <div class="col-sm-4" id="moreItemQuantityEdit">
                    </div>
                    <div class="col-sm-2">

                    </div>

                </div>
                <div class="row" style="padding-top:20px;">

                    <div class="col-sm-3">
                        <button class="btn" style="padding:2px;" onclick="addMoreOnSpotEdit()">Add More</button>

                    </div>

                    <div class="col-sm-3">
                        <button class="btn" onclick="ConfirmEdit()" style="padding:3px;"> Save</button>
                    </div>
                    <div class="col-sm-3">
                        <button class="btn" onclick="CloseModal()" style="padding:3px;"> Close</button>

                    </div>
                    <div class="col-sm-3">
                        <div id="apprvBtn" style="display:block;">
                            <button class="btn btn-sm btn-danger" style="padding:3px;" onclick="ConfirmEditApprove()"> Approve </button>

                        </div>
                        <div id="apprvState" style="display:none;">
                            <span class="badge badge-success">Approved</span>

                        </div>




                    </div>
                </div>

            </div>
        </div>
        <div id="myModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
                <div class="card" style="margin-left:-20px;">
                    <div class="card-header card-header-tabs card-header-success" style="padding-top:5px;height:60px;">
                        <div class="row">
                            <div class="col-md-8">


                                <div class="nav-tabs-navigation">
                                    <div class="nav-tabs-wrapper">
                                        <ul class="nav nav-tabs" data-tabs="tabs">
                                            <li class="nav-item" style="margin-right:50px;">
                                                <a class="nav-link active" href="#party" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Party
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item" style="margin-left:30px;">
                                                <a class="nav-link" href="#official" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Official
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>


                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">


                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="party">

                                <div class="row">
                                    <div class="col-md-8">

                                    </div>
                                    <div class="col-md-4">
                                        <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="OpenPartyInput()" class="btn"><i class="fas fa-plus"></i>&nbsp;New Order</button>

                                    </div>

                                </div>

                                <div id="PartyDB" class="row">
                                    @{
                                        var specialMenu = _context.SpecialMenuParent.Where(x => x.OrderDate >= DateTime.Now && x.MealTypeId == 10006).ToList();
                                        var distinctPersonDateList = specialMenu
.GroupBy(m => new { m.Id, m.UserId, m.OrderDate })
.Select(group => group.First())  // instead of First you can also apply your logic here what you want to take, for example an OrderBy
.ToList();

                            <table class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Date</th>

                                        <th>Name</th>
                                        <th>ItemDetail</th>

                                        <th></th>
                                        <th> </th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (var item in distinctPersonDateList)
                                    {
                                        var specialMenuParty = _context.SpecialMenuOrder.Where(x => x.SpecialMenuParentId == item.Id).ToList();

                                        <tr>
                                            <td> 1 </td>
                                            <td>
                                                <div class="row">
                                                    <div class="col-sm-8">
                                                        @item.OrderDate.ToShortDateString()

                                                    </div>
                                                    <div class="col-sm-4">
                                                        <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                    </div>

                                                </div>


                                            </td>
                                            <td>

                                                <div class="row">
                                                    <div class="col-sm-8">
                                                        @_userManager.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPFullName;


                                                    </div>
                                                    <div class="col-sm-4">
                                                        <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                    </div>

                                                </div>
                                            </td>


                                            <td>
                                                @foreach (var i in specialMenuParty)
                                                {
                                                    //if (item.UserId == i.UserId && item.OrderDate == i.OrderDate)
                                                    //{
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            @_context.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault().Name

                                                        </div>
                                                        <div class="col-sm-4">
                                                            @i.UnitOrdered
                                                        </div>
                                                        <div class="col-sm-2">
                                                            <button type="button" rel="tooltip" onclick="EditParty(@i.Id)" class="btn"><i class="fas fa-edit"></i></button>

                                                        </div>

                                                        <div class="col-sm-2">

                                                        </div>
                                                    </div>
                                                    @*}*@
                                                }
                                            </td>
                                        </tr>

                                    }
                                </tbody>
                            </table>

                                    }


                                    @*<table class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Date</th>

                                            <th>Name</th>
                                            <th>ItemDetail</th>

                                            <th></th>
                                            <th> </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            var prevuser = "";
                                            var prevdte = "";

                                            @for (var i = 0; i < specialMenu.Count; i++)
                                            {
                                                @if (prevuser != specialMenu[i].UserId || prevdte != specialMenu[i].OrderDate.ToShortDateString())
                                                {


                                                    <tr>
                                                        <td> 1</td>
                                                        <td> @specialMenu[i].UserId </td>
                                                        <td> @specialMenu[i].OrderDate</td>
                                                        <td>
                                                            <div class="row">
                                                                <div class="col-sm-4">

                                                                </div>
                                                                <div class="col-sm-4">

                                                                </div>
                                                                <div class="col-sm-2">

                                                                </div>

                                                                <div class="col-sm-2">

                                                                </div>

                                                            </div>

                                                }
                                                else
                                                {
                                                    <div class="row">
                                                        <div class="col-sm-4">

                                                        </div>
                                                        <div class="col-sm-4">

                                                        </div>
                                                        <div class="col-sm-2">

                                                        </div>

                                                        <div class="col-sm-2">

                                                        </div>

                                                    </div>
                                                }



                                                @if (specialMenu[i].UserId != specialMenu[i + 1].UserId || specialMenu[i].OrderDate.ToShortDateString() != specialMenu[i + 1].OrderDate.ToShortDateString())
                                                {
                                                    </td>
                                                }
                                            }
                                        }





                                    </tbody>
                                        </table>*@

                                </div>

                                <div id="PartyEditOption">

                                </div>



                                <div id="PartyDateEditOption">


                                </div>
                                <div id="PartyPersonEditOption">

                                </div>
                                <div id="AfterPartyEdit">

                                </div>
                                <div id="AfterPartyDateEdit">

                                </div>
                                <div id="AfterPartyNameEdit">

                                </div>

                                <div id="AfterPartyDelete">

                                </div>

                                <div id="AfterBack">

                                </div>


                                <div id="PartyInput">
                                    <div class="row">
                                        <div class="col-md-6">

                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Person</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">person</i>
                                                    <input type="text" name="partyperson" id="partyperson" class="form-control" value="" />
                                                </div>
                                                <div id="partypersonbox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div style="display:inline-flex">
                                                <i class="material-icons" style="padding-top:5px;">calendar_today</i>
                                                <input type="text" name="partydate" id="partydate" class="form-control" value="" />
                                            </div>

                                        </div>





                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                @*<label class="bmd-label-floating">Item</label>*@
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">local_dining</i>
                                                    <input type="text" name="partyitem" id="partyitem" class="form-control" value="" />


                                                </div>
                                                <div id="partyitembox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">

                                            <input type="number" name="piq" id="piq" class="form-control" />

                                        </div>


                                        <div id="PriceDiv" class="col-md-2" style="display:none;">

                                            <input type="number" name="pr" id="pr" class="form-control" placeholder="price" />

                                        </div>

                                        <div class="col-md-1">

                                            <button type="button" style="padding:5px;" rel="tooltip" onclick="AddPartyItem()" class="btn"><i class="fas fa-plus"></i></button>



                                        </div>






                                    </div>
                                    <div class="row">
                                        <div class="col-md-9"></div><div class="col-md-3">
                                            <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseParty()" class="btn">Back</button>
                                        </div>
                                    </div>
                                    <br />

                                    <br />
                                    <br />
                                    <div id="InputDetail">


                                    </div>

                                </div>



                            </div>
                            <div class="tab-pane" id="official">
                                <div class="row">
                                    <div class="col-md-8">

                                    </div>
                                    <div class="col-md-4">
                                        <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="OpenOfficeInput()" class="btn"><i class="fas fa-plus"></i>&nbsp;New Order</button>

                                    </div>

                                </div>

                                <div id="OfficeDB" class="row">
                                    @{
                                        var specialMenu2 = _context.SpecialMenuParent.Where(x => x.OrderDate >= DateTime.Now && x.MealTypeId == 10007).ToList();
                                        var distinctPersonDateList2 = specialMenu2
.GroupBy(m => new { m.Id, m.OfficeId, m.OrderDate })
.Select(group => group.First())  // instead of First you can also apply your logic here what you want to take, for example an OrderBy
.ToList();

                            <table class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Date</th>

                                        <th>Name</th>
                                        <th>ItemDetail</th>

                                        <th></th>
                                        <th> </th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (var item in distinctPersonDateList2)
                                    {
                                        var specialMenuOffice = _context.SpecialMenuOrder.Where(x => x.SpecialMenuParentId == item.Id).ToList();

                                        <tr>
                                            <td> 1 </td>
                                            <td>
                                                <div class="row">
                                                    <div class="col-sm-8">
                                                        @item.OrderDate.ToShortDateString()

                                                    </div>
                                                    <div class="col-sm-4">
                                                        <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                    </div>

                                                </div>


                                            </td>
                                            <td>

                                                <div class="row">
                                                    <div class="col-sm-8">
                                                        @_context.Office.Where(x => x.Id == item.OfficeId).FirstOrDefault().Name;


                                                    </div>
                                                    <div class="col-sm-4">
                                                        <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(@item.Id)" class="btn"><i class="fas fa-edit"></i></button>


                                                    </div>

                                                </div>
                                            </td>


                                            <td>
                                                @foreach (var i in specialMenuOffice)
                                                {
                                                    //if (item.UserId == i.UserId && item.OrderDate == i.OrderDate)
                                                    //{
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            @_context.StoreOutItem.Where(x => x.Id == i.StoreOutItemId).FirstOrDefault().Name

                                                        </div>
                                                        <div class="col-sm-4">
                                                            @i.UnitOrdered
                                                        </div>
                                                        <div class="col-sm-2">
                                                            <button type="button" rel="tooltip" onclick="EditOffice(@i.Id)" class="btn"><i class="fas fa-edit"></i></button>

                                                        </div>

                                                        <div class="col-sm-2">

                                                        </div>
                                                    </div>
                                                    @*}*@
                                                }
                                            </td>
                                        </tr>

                                    }
                                </tbody>
                            </table>

                                    }


                                    @*<table class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Date</th>

                                            <th>Name</th>
                                            <th>ItemDetail</th>

                                            <th></th>
                                            <th> </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            var prevuser = "";
                                            var prevdte = "";

                                            @for (var i = 0; i < specialMenu.Count; i++)
                                            {
                                                @if (prevuser != specialMenu[i].UserId || prevdte != specialMenu[i].OrderDate.ToShortDateString())
                                                {


                                                    <tr>
                                                        <td> 1</td>
                                                        <td> @specialMenu[i].UserId </td>
                                                        <td> @specialMenu[i].OrderDate</td>
                                                        <td>
                                                            <div class="row">
                                                                <div class="col-sm-4">

                                                                </div>
                                                                <div class="col-sm-4">

                                                                </div>
                                                                <div class="col-sm-2">

                                                                </div>

                                                                <div class="col-sm-2">

                                                                </div>

                                                            </div>

                                                }
                                                else
                                                {
                                                    <div class="row">
                                                        <div class="col-sm-4">

                                                        </div>
                                                        <div class="col-sm-4">

                                                        </div>
                                                        <div class="col-sm-2">

                                                        </div>

                                                        <div class="col-sm-2">

                                                        </div>

                                                    </div>
                                                }



                                                @if (specialMenu[i].UserId != specialMenu[i + 1].UserId || specialMenu[i].OrderDate.ToShortDateString() != specialMenu[i + 1].OrderDate.ToShortDateString())
                                                {
                                                    </td>
                                                }
                                            }
                                        }





                                    </tbody>
                                        </table>*@

                                </div>
                                <div id="OfficeInput">
                                    <div class="row">
                                        <div class="col-md-4">

                                            <div class="form-group">
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">person</i>
                                                    <input type="text" name="officeperson" id="officeperson" class="form-control" value="" />
                                                </div>
                                                <div id="officepersonbox"></div>
                                            </div>
                                        </div>

                                        <div class="col-md-4">

                                            <div class="form-group">
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">house</i>
                                                    <input type="text" name="officename" id="officename" class="form-control" value="" />
                                                </div>
                                                <div id="officebox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div style="display:inline-flex">
                                                <i class="material-icons" style="padding-top:5px;">calendar_today</i>
                                                <input type="text" name="officedate" id="officedate" class="form-control" value="" />
                                            </div>

                                        </div>





                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <div style="display:inline-flex">
                                                    <i class="material-icons" style="padding-top:5px;">local_dining</i>
                                                    <input type="text" name="officeitem" id="officeitem" class="form-control" value="" />


                                                </div>
                                                <div id="officeitembox"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">

                                            <input type="number" name="oiq" id="oiq" class="form-control" placeholder="quantity" />

                                        </div>

                                        <div id="OffPriceDiv" class="col-md-2" style="display:none;">

                                            <input type="number" name="offpr" id="offpr" class="form-control" placeholder="price" />

                                        </div>

                                        <div class="col-md-1">

                                            <button type="button" style="padding:5px;" rel="tooltip" onclick="AddOfficeItem()" class="btn"><i class="fas fa-plus"></i></button>



                                        </div>





                                    </div>
                                    <div class="row">
                                        <div class="col-md-9"></div><div class="col-md-3">
                                            <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseOffice()" class="btn">Back</button>
                                        </div>
                                    </div>

                                </div>




                                <div id="OfficeInputDetail">


                                </div>

                                <div id="OfficeEditOption">

                                </div>

                                <div id="OfficeDateEditOption">


                                </div>
                                <div id="OfficeNameEditOption">

                                </div>
                                <div id="AfterOfficeEdit">

                                </div>
                                <div id="AfterOfficeDateEdit">

                                </div>
                                <div id="AfterOfficeNameEdit">

                                </div>

                                <div id="AfterOfficeDelete">

                                </div>

                                <div id="AfterOfficeBack">

                                </div>



                            </div>
                        </div>
                    </div>





                </div>




            </div>

        </div>
        <div class="modal fade" id="fileUploadModal" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title">Add Comment</h4>
                    </div>
                    <div class="modal-body">
                        <textarea id="commentsUpload" class="form-control custom-control" rows="3"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" onclick="submitXYX()" data-dismiss="modal">Submit</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="PreBrkList" class="modal">
            <div class="modal-content">
                <div class="modal-body">
                    <div id="PreBrkTable">
                        <table>
                            <thead>
                                <tr>
                                    <th>

                                    </th>
                                </tr>

                            </thead>
                            <tbody>
                                @foreach (var bm in brkModalList)
                                {
                 var usr = _userManager.Users.Where(x => x.Id == bm.UserId).FirstOrDefault();

                                <tr>
                                    <td style="font-weight:bold;">
                                        @usr.BUPNumber-@usr.BUPFullName
                                    </td>
                                </tr>
                    }
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">

                    <button class="btn btn-success" style="padding:3px;" onclick="printPreModal('PreBrkTable')">
                        Print
                    </button>
                    <button class="btn btn-success" style="padding:3px;" onclick="closePreModal(1)">
                        Close
                    </button>

                </div>

            </div>
            
        </div>

        <div id="PreLnList" class="modal">
            <div class="modal-content">
                <div class="modal-body">
                    <div id="PreLnTable">
                    <table>
                        <thead>
                            <tr>
                                <th>

                                </th>
                            </tr>

                        </thead>
                        <tbody>
                            @foreach (var bm in lnModalList)
                            {
                                      var usr = _userManager.Users.Where(x => x.Id == bm.UserId).FirstOrDefault();
             
                            <tr>
                                <td style="font-weight:bold;">
                                    @usr.BUPNumber-@usr.BUPFullName
                                </td>
                            </tr>
                            }
                        </tbody>
                    </table>
                        </div>
                </div>
                <div class="modal-footer">

                        <button class="btn btn-success" style="padding:3px;" onclick="printPreModal('PreLnTable')">
                            Print
                        </button>
                        <button class="btn btn-success" style="padding:3px;" onclick="closePreModal(2)">
                            Close
                        </button>

                </div>
            </div>
            
        </div>
        <div id="PreTBrkList" class="modal">
            <div class="modal-content">
                <div class="modal-body">
                    <div id="PreTBrkTbl">
                    <table>
                        <thead>
                            <tr>
                                <th>

                                </th>
                            </tr>

                        </thead>
                        <tbody>
                            @foreach (var bm in tbrkModalList)
                            {
                var usr = _userManager.Users.Where(x => x.Id == bm.UserId).FirstOrDefault();

                            <tr>
                                <td style="font-weight:bold;">
                                    @usr.BUPNumber-@usr.BUPFullName
                                </td>
                            </tr>
                }
                        </tbody>
                    </table>
                    </div>
                    
                </div>
                <div class="modal-footer">

                    <button class="btn btn-success" style="padding:3px;" onclick="printPreModal('PreTBrkTbl')">
                        Print
                    </button>
                    <button class="btn btn-success" style="padding:3px;" onclick="closePreModal(3)">
                        Close
                    </button>

                </div>
            </div>
         
        </div>
        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-warning card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">content_copy</i>
                        </div>
                        <p class="card-category">Breakfast</p>
                        @*@{
                            double OnOffSetMenuBrk = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuBrk = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 1 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuBrk = OnOffSetMenuBrk + ExtSetMenuBrk;
                        }*@
                    <h3 class="card-title">
                        <button onclick="OpenPreOrderModel(1)">

                            @brkModalList.Count
                            <small>pcs</small>
                        </button>

                    </h3>
                    
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            @*<i class="material-icons text-danger">warning</i>*@
                            @*<a href="#pablo">Unserved @TtlSetMenuBrk pcs</a>*@
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-success card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">store</i>
                        </div>
                        <p class="card-category">Lunch</p>
                        @*@{
                            double OnOffSetMenuLnch = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 2).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuLnch = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 2 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuLnch = OnOffSetMenuLnch + ExtSetMenuLnch;
                        }*@
                    <h3 class="card-title">
                        <button onclick="OpenPreOrderModel(2)">

                            @lnModalList.Count
                            <small>pcs</small>
                            </button>
                    </h3>

                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            @*<i class="material-icons">date_range</i>Unserved  @TtlSetMenuLnch pcs*@
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-danger card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">info_outline</i>
                        </div>

                        <p class="card-category">TeaBreak</p>
                        @*@{
                            double OnOffSetMenuTBrk = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 3).Select(x => x.IsPreOrderSet).Count();
                            double ExtSetMenuTBrk = _db.OrderHistory.Where(x => x.OrderDate.ToShortDateString() == OrderDate && x.MealTypeId == 3 && x.StoreOutItemId == null).Select(x => x.UnitOrdered).Sum();
                            double TtlSetMenuTBrk = OnOffSetMenuTBrk + ExtSetMenuTBrk;
                        }*@
                    <h3 class="card-title">
                        <button onclick="OpenPreOrderModel(3)">

                            @tbrkModalList.Count
                            <small>pcs</small>
                            </button>
                    </h3>
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            @*<i class="material-icons">date_range</i>Unserved  @TtlSetMenuTBrk pcs*@
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="card card-stats">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon">
                            <i class="fa fa-clock"></i>
                        </div>
                        <p class="card-category">Last Order Time</p>
                        @*<div class="input-group clockpicker" style="width: 50%; float: left;">
                        <i class="material-icons">clock</i>*@
                        <input id="ordTime" type="text" value="@lastTime.Value" onchange="setOrderTime()" class="form-control clockpicker">

                        @*<input type="time" id="Time" class="form-control clockpicker" value="2 p.m.">*@
                        @*<span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>*@
                        @*</div>*@
                    </div>
                    <div class="card-footer">
                        <div class="stats">
                            <i class="material-icons">update</i> Can Be Changed
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4">

                <div class="card">
                    <div class="card-header-success">
                        <h4>
                            On Spot Order
                        </h4>
                    </div>
                    <div class="body">
                        <div class="row">
                            <div class="col-sm-2">

                            </div>
                            <div class="col-sm-4">
                                <input type="radio" name="orderType" onchange="loadOnSpotSpace()" id="personal" checked>Personal
                            </div>
                            <div class="col-sm-4">
                                <input type="radio" name="orderType" onchange="loadOnSpotSpace()" id="official">Official

                            </div>
                            <div class="col-sm-2">

                                @*<button class="btn"><i class="fa fa-remove"></i></button>*@

                            </div>
                        </div>
                        <div id="personOrder">
                            <div class="row">
                                @*<div class="col-sm-2">

                                </div>*@
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Person</label>
                                        <div>
                                            @*<i class="material-icons" style="padding-top:5px;">person</i>*@
                                            <input type="text" name="onspotPerson" id="onspotPerson" class="form-control" value="" required />
                                        </div>
                                        <div id="suggesstion-box"></div>
                                    </div>
                                </div>
                                @*<div class="col-sm-2" style="padding-top:25px;">

                                </div>*@
                                <div class="col-sm-6">
                                    <label class="bmd-label-floating">Bearer</label>
                                    <div style="display:inline-flex">
                                        @*<i class="material-icons" style="padding-top:5px;">person</i>*@
                                        <input type="text" name="onspotBearer" id="onspotBearer" class="form-control" value="" />
                                    </div>
                                    <div id="suggesstion-box3"></div>

                                </div>


                            </div>
                            <div class="row">
                                @*<div class="col-sm-2">

                                </div>*@
                                <div class="col-sm-6">
                                    @*<div class="form-group">
                                    <label class="bmd-label-floating">Item</label>
                                    <br />
                                    <div style="display:inline-flex">*@

                                    @*<i class="material-icons" style="padding-top:6px;">local_dining</i>*@
                                    <select id="onspotItem1" name="onspotItem1" onchange="checkRepeatValue(1)" class="form-control border-radius-none" asp-items="@(new SelectList(OnSpotList.Prepend(new KeyValuePair<string, string>("0", "Select Item")), "Key", "Value", "Select Item"))"></select>

                                    @*</div>


                                    </div>*@
                                </div>
                                <div class="col-sm-4" style="margin-top:0px;">
                                    @*<div class="form-group">
                                    <label class="bmd-label-floating">Quantity</label>
                                    <div style="display:inline-flex">*@
                                    @*<i class="material-icons" style="padding-top:6px;">double_arrow</i>*@
                                    <input type="number" id="itmQ1" name="itmQ1" class="form-control" min="1" required placeholder="quantity" />
                                    @*</div>
                                    </div>*@
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                @*<div class="col-sm-2">

                                </div>*@
                                <div class="col-sm-6" id="moreItemDrop">

                                </div>
                                <div class="col-sm-4" id="moreItemQuantity">
                                </div>
                                <div class="col-sm-2" id="removeMore">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4">

                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-success" style="padding:2px;" onclick="addMoreOnSpot(1)">Add More</button>
                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-success" style="padding:2px;" onclick="addOnSpotItem(1)">Confirm</button>

                                </div>
                            </div>
                        </div>

                        <div class="row" id="officeOrder" style="display:none;">
                            <div class="row">
                                <div class="col-sm-2">

                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Office</label>
                                        <div style="display:inline-flex">
                                            <input type="text" name="onspotOffice" id="onspotOffice" class="form-control" value="" required />
                                        </div>
                                        <div id="suggesstion-box2"></div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="bmd-label-floating">Bearer</label>
                                    <div style="display:inline-flex">
                                        <input type="text" name="onspotOfficeBearer" id="onspotOfficeBearer" class="form-control" value="" />
                                    </div>
                                    <div id="suggesstion-box4"></div>

                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-2">

                                </div>
                                <div class="col-sm-4">
                                    @*<div class="form-group">
                                    <label class="bmd-label-floating">Item</label>
                                    <br />
                                    <div style="display:inline-flex">*@

                                    @*<i class="material-icons" style="padding-top:6px;">local_dining</i>*@
                                    <select id="onspotOfficeItem1" name="onspotOfficeItem1" onchange="checkRepeatValue(2)" class="form-control border-radius-none" asp-items="@(new SelectList(OnSpotList.Prepend(new KeyValuePair<string, string>("0", "")), "Key", "Value", ""))"></select>

                                    @*</div>


                                    </div>*@
                                </div>
                                <div class="col-sm-4" style="margin-top:0px;">
                                    @*<div class="form-group">
                                    <label class="bmd-label-floating">Quantity</label>
                                    <div style="display:inline-flex">*@
                                    @*<i class="material-icons" style="padding-top:6px;">double_arrow</i>*@
                                    <input type="number" id="itmOfficeQ1" name="itmOfficeQ1" class="form-control" min="1" required />
                                    @*</div>
                                    </div>*@
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-2">

                                </div>
                                <div class="col-sm-4" id="moreOfficeItemDrop">

                                </div>
                                <div class="col-sm-4" id="moreOfficeItemQuantity">
                                </div>
                                <div class="col-sm-2" id="removeOfficeMore">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4">

                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-success" style="padding:2px;" onclick="addMoreOnSpot(2)">Add More</button>
                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-success" style="padding:2px;" onclick="addOnSpotItem(2)">Confirm</button>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            @*<div class="col-sm-4">
                <div class="card card-chart">
                    <div class="card-header card-header-success">
                        <h5 style="font-weight:bold">On Spot Order</h5>
                    </div>
                    <div class="card-body">


                        <div class="row">
                            <div class="col-sm-1">

                            </div>
                            <div class="col-sm-4">
                                <input type="radio" name="orderType" onchange="loadOnSpotSpace()" id="personal" checked>
                                <label>Personal</label>
                            </div>
                            <div class="col-sm-4">
                                <input type="radio" name="orderType" onchange="loadOnSpotSpace()" id="official">
                                <label>Official</label>

                            </div>
                            <div class="col-sm-3">

                            </div>
                        </div>
                        <div id="personOrder">
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5">
                                        <label class="bmd-label-floating">Person</label>
                                        <div style="display:inline-flex">
                                            <input type="text" name="onspotPerson" id="onspotPerson" class="form-control" value="" required />
                                        </div>
                                        <div id="suggesstion-box"></div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="bmd-label-floating">Bearer</label>
                                    <div style="display:inline-flex">
                                        <input type="text" name="onspotBearer" id="onspotBearer" class="form-control" value="" />
                                    </div>
                                    <div id="suggesstion-box3"></div>

                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Item</label>
                                        <br />
                                        <div style="display:inline-flex">

                                            <select id="onspotItem1" name="onspotItem1" onchange="checkRepeatValue(1)" class="form-control border-radius-none" asp-items="@(new SelectList(OnSpotList.Prepend(new KeyValuePair<string, string>("0", "")), "Key", "Value", ""))"></select>

                                        </div>


                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Quantity</label>
                                        <div style="display:inline-flex">
                                            <input type="number" id="itmQ1" name="itmQ1" class="form-control" min="1" required />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5" id="moreItemDrop">

                                </div>
                                <div class="col-sm-4" id="moreItemQuantity">
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4">

                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-sm btn-success" style="padding:5px;" onclick="addMoreOnSpot(1)">Add More</button>
                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-sm btn-success" style="padding:5px;" onclick="addOnSpotItem(1)">Confirm</button>

                                </div>
                            </div>
                        </div>

                        <div class="row" id="officeOrder" style="display:none;">
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5">
                                        <label class="bmd-label-floating">Office</label>
                                        <div style="display:inline-flex">
                                            <input type="text" name="onspotOffice" id="onspotOffice" class="form-control" value="" required />
                                        </div>
                                        <div id="suggesstion-box2"></div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="bmd-label-floating">Bearer</label>
                                    <div style="display:inline-flex">
                                        <input type="text" name="onspotOfficeBearer" id="onspotOfficeBearer" class="form-control" value="" />
                                    </div>
                                    <div id="suggesstion-box4"></div>

                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Item</label>
                                        <br />
                                        <div style="display:inline-flex">

                                            <select id="onspotOfficeItem1" name="onspotOfficeItem1" onchange="checkRepeatValue(2)" class="form-control border-radius-none" asp-items="@(new SelectList(OnSpotList.Prepend(new KeyValuePair<string, string>("0", "")), "Key", "Value", ""))"></select>

                                        </div>


                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="bmd-label-floating">Quantity</label>
                                        <div style="display:inline-flex">
                                            <input type="number" id="itmOfficeQ1" name="itmOfficeQ1" class="form-control" min="1" required />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-1">

                                </div>
                                <div class="col-sm-5" id="moreOfficeItemDrop">

                                </div>
                                <div class="col-sm-4" id="moreOfficeItemQuantity">
                                </div>
                                <div class="col-sm-2">

                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4">

                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-sm btn-success" style="padding:5px;" onclick="addMoreOnSpot(2)">Add More</button>
                                </div>
                                <div class="col-sm-4">
                                    <button class="btn btn-sm btn-success" style="padding:5px;" onclick="addOnSpotItem(2)">Confirm</button>

                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>*@

            <div class="col-sm-8">
                <div class="card">
                    <div class="card-header card-header-tabs card-header-danger" style="padding-top:5px;height:60px;">
                        <div class="row">
                            <div class="col-sm-8" style="font-weight: bold; font-size:16px; padding-top: 10px;">

                                Today's On Spot Order List

                            </div>
                            <div class="col-sm-4">
                                <div class="input-group no-border">
                                    <input type="text" id="tableSearchInput" autocomplete="off" class="form-control col-sm-8" onkeyup="tableFilter()" placeholder="Search">


                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="card-body">


                        <table class="table list-group table-bordered" id="onSpotTable" style="padding-left: 5px;overflow-y: auto;">
                            @*<thead>
                                <tr>
                                    <th>Order Type</th>
                                    <th>Order For </th>
                                    <th>Order By</th>
                                    <th>Bear By</th>
                                    <th>Item </th>
                                    <th>Quantity</th>

                                    <th></th>
                                </tr>
                            </thead>*@
                            <tbody>
                                <tr>
                                    <td class="onSpotHead">Order Type</td>
                                    <td class="onSpotHead">Order For </td>
                                    <td class="onSpotHead">Order By</td>
                                    <td class="onSpotHead">Bear By</td>
                                    <td class="onSpotHead">Time</td>
                                    <td class="onSpotHead">Item </td>
                                    <td class="onSpotHead">Quantity</td>

                                    <td class="onSpotHead">Action</td>
                                    <td class="onSpotHead">Approval Status</td>
                                </tr>
                                @foreach (var item in onSpotOrderList)
                                {
                                    var orderType = item.IsOfficeOrder == true ? "Official" : "Personal";
                                    var isApprove = item.IsApproved;
                                    var orderFor = item.IsOfficeOrder == true ? _context.Office.Where(x => x.Id == item.OfficeId).FirstOrDefault().Name :
                                    _context.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPNumber + '-' +   
                                    _context.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPFullName;
                                                                var orderBy = item.CreatedBy == null ? "-" : _context.Users.Where(x => x.Id == item.CreatedBy).FirstOrDefault().BUPFullName;
    
                                //var orderBy = _context.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPNumber + '-' + _context.Users.Where(x => x.Id == item.UserId).FirstOrDefault().BUPFullName;
                                    var bearBy = item.BearerId == null ? "-" : _context.Users.Where(x => x.Id == item.BearerId).FirstOrDefault().BUPNumber + '-'+ _context.Users.Where(x => x.Id == item.BearerId).FirstOrDefault().BUPFullName;
                                    var ind = 0;
                                    var onSpotDetailList = _context.CustomerChoiceV2.Where(x => x.OnSpotParentId == item.Id).ToList();
                                    if (onSpotDetailList.Count > 0)
                                    {
                                        <tr>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @orderType
                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @orderFor
                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @orderBy
                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @bearBy
                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">

                                                @item.Date.ToString("h:mm tt")
                                            </td>
                                            <td>
                                                @{
                                                    //var ex = _context.ExtraItem.Where(x => x.Id == onSpotDetailList.ElementAt(0).ExtraItemId).FirstOrDefault();
                                                    var itm = _context.StoreOutItem.Where(x => x.Id == onSpotDetailList.ElementAt(0).StoreOutItemId).FirstOrDefault(); }
                                                @itm.Name
                                            </td>
                                            <td>
                                                @onSpotDetailList.ElementAt(0).quantity
                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @if (!isApprove)
                                                {@*<a asp-action="EditOnSpotItem" asp-route-id="@onSpotDetailList.ElementAt(0).Id"><i class="far fa-edit"></i></a>*@
                                                                        <button class="btn btn-sm btn-danger" style="padding:3px;" onclick="editOrder(@item.Id)"> Edit </button>
                                                }
                                                                                            </td>
                                            <td rowspan="@onSpotDetailList.Count">
                                                @if (!isApprove)
                                                {
                                                    <button class="btn btn-sm btn-danger" style="padding:3px;" onclick="approveOrder(@item.Id)"> Approve </button>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-success">Approved</span>
                                                }
                                            </td>
                                            @*<td>
                                                <a asp-action="OnSpotItem" asp-route-id="@onSpotDetailList.ElementAt(0).Id"><i class="far fa-edit"></i></a>

                                            </td>*@
                                        </tr>

                                        @foreach (var o in onSpotDetailList)
                                        {
                                            if (ind > 0)
                                            {
                                                <tr>
                                                    <td>
                                                        @{
                                                            //var ex2 = _context.ExtraItem.Where(x => x.Id == o.ExtraItemId).FirstOrDefault();
                                                            var itm2 = _context.StoreOutItem.Where(x => x.Id == o.StoreOutItemId).FirstOrDefault(); }
                                                        @itm2.Name
                                                    </td>
                                                    <td>
                                                        @o.quantity
                                                    </td>


                                                </tr>
                                            }

                                            ind++;
                                        }}
                                }

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
        <div class="row">

            @*<div class="col-sm-1">

            </div>*@

            <div class="col-sm-11">
                <div class="card">
                    <div class="card-header card-header-tabs card-header-success" style="padding-top:5px;height:60px;">
                        <div class="row">
                            <div class="col-md-8">


                                <div class="nav-tabs-navigation">
                                    <div class="nav-tabs-wrapper">
                                        <span class="nav-tabs-title">Meal:</span>
                                        <ul class="nav nav-tabs" data-tabs="tabs">
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 1 ? "nav-link active" : "nav-link")" href="#breakfast" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> Breakfast
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 3 ? "nav-link active" : "nav-link")" href="#teabreak" data-toggle="tab">
                                                    <i class="material-icons">bug_report</i> TeaBreak
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 2 ? "nav-link active" : "nav-link")" href="#lunch" data-toggle="tab">
                                                    <i class="material-icons">cloud</i> Lunch
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="@(lastUpdate == 10005 ? "nav-link active" : "nav-link")" href="#EC" data-toggle="tab">
                                                    <i class="material-icons">cloud</i> ExtraChit
                                                    <div class="ripple-container"></div>
                                                </a>
                                            </li>

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <form asp-action="FetchOrderDate" asp-controller="AdminShowOrder" method="post">
                                    <div class="input-group no-border">

                                        <input type="text" id="datepicker" name="datepicker" autocomplete="off" value="@showdate" class="form-control col-sm-8" placeholder="Search..." required>
                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                            <i class="material-icons">search</i>
                                            <div class="ripple-container"></div>
                                        </button>
                                    </div>

                                </form>

                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tab-content">
                            <div class="@(lastUpdate == 1 ? "tab-pane active" : "tab-pane")" id="breakfast">
                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect == 1 ? "nav-link active" : "nav-link")" href="#BP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect == 2 ? "nav-link active" : "nav-link")" href="#BI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect == 1 ? "tab-pane active" : "tab-pane")" id="BP">


                                        <div class="row">
                                            <div class="col-sm-6">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder" asp-action="FetchPersonOrder" asp-route-MealId="1" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person" name="person" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-2">

                                                <button onclick="Print('BreakfastPerson',800,700,'Breakfast',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="BreakfastPerson" style="padding-top:0px;">

                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 1)
                                                {
                                                    var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial) || x.BUPNumber.Contains(personNamePartial)).ToList();

                                                    var pr = from p in PersonList
                                                             join o in DistinConsumerListBrk
                                                             on p.Id equals o
                                                             // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                             select o;
                                                    var pList = pr.ToList();
                                                    DistinConsumerListBrk = pList;
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                    //PreOrderSetMenuDetailList = pList;
                                                }
                                            }

                                            <table class="table list-group" style="padding-left:75px;">
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListBrk)
                                                    {
                                                        var ListOfItem = ConsumerDtlListBrk.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                        .GroupBy(a => a.ExtraItemId)
                                                        .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                        .ToList();

                                                        //  var specificPersonChoiceList = ConsumerDtlListBrk.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                    var usr = _userManager.Users.Where(x => x.Id == p).FirstOrDefault();
                                                    <tr>
                                                        <td>@usr.BUPNumber-@usr.BUPFullName;</td>
                                                        @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";

                                                                   if(brkTotalItemDict.ContainsKey(storeOutItemName))
                                                                {
                                                                    brkTotalItemDict[storeOutItemName] = (Int32.Parse(brkTotalItemDict[storeOutItemName])
                                                                        + spo.Amount).ToString();
                                                                }
                                                                else
                                                                {
                                                                    brkTotalItemDict.Add(storeOutItemName, spo.Amount.ToString());
                                                                }
                                                            }

                                                        <td>@ItemDetail</td>


                                                    </tr>
                                                    }

                                                    @{
                                                            var indexB = 0;

                                                            foreach (var i in brkTotalItemDict)
                                                            {
                                                        <tr>
                                                            @if (indexB++ == 0)
                                                                    {
                                                            <td rowspan="@brkTotalItemDict.Count">Total </td>
                                                                    }

                                                            <td> @i.Key - @i.Value   </td>
                                                        </tr>


                                                            }
                                                    }


                                                </tbody>
                                            </table>

                                        </div>

                                    </div>
                                    <div class="@(subMenuDetect== 2 ? "tab-pane active":"tab-pane")" id="BI">

                                        <div class="row">
                                            <div class="col-sm-6">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder" asp-action="FetchItemOrder" asp-route-MealId="1" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item" name="item" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-2">

                                                <button onclick="Print('BreakfastItem',800,700,'Breakfast',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>
                                            </div>
                                        </div>
                                        @{





                                            <div id="BreakfastItem" style="padding-top:0px;">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    @if (ViewBag.MealId != null)
                                                    {
                                                        if (lastUpdate == 1)
                                                        {
                                                            var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                            var or = from p in ItemList
                                                                     join o in _db.ExtraItem
                                                                      on p.Id equals o.StoreOutItemId
                                                                     where o.Day == day && o.MealTypeId == 1
                                                                     select o;
                                                            var di = from ro in or
                                                                     join dib in DistinItemListBrk
                                                                     on ro.Id equals dib
                                                                     select dib;

                                                            //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                            DistinItemListBrk = di.ToList();
                                                            //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        }
                                                    }

                                                    <tbody>
                                                        @foreach (var itm in DistinItemListBrk)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListBrk.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>

                                            </div>
                                        }


                                    </div>
                                </div>

                            </div>
                            <div class="@(lastUpdate == 3 ? "tab-pane active":"tab-pane")" id="teabreak">
                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect2 == 1 ? "nav-link active" : "nav-link")" href="#TP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect2 == 2 ? "nav-link active" : "nav-link")" href="#TI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>

                                <div class="tab-content">

                                    <div class="@(subMenuDetect2 == 1 ? "tab-pane active" : "tab-pane")" id="TP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder2" asp-action="FetchPersonOrder" asp-route-MealId="3" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person2" name="person2" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('TBreakPerson',800,700,'TeaBreak',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        <div id="TBreakPerson">
                                            <table class="table list-group" style="padding-left:75px;">


                                                @*@if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 1)
                                                    {
                                                        var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial)).ToList();

                                                        var pr = from p in PersonList
                                                                 join o in DistinConsumerListBrk
                                                                 on p.Id equals o
                                                                 // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                                 select o;
                                                        var pList = pr.ToList();
                                                        DistinConsumerListBrk = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }*@
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 3)
                                                    {
                                                        var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial) || x.BUPNumber.Contains(personNamePartial)).ToList();

                                                        var pr = from p in PersonList
                                                                 join o in DistinConsumerListTBrk
                                                                 on p.Id equals o
                                                                 // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                                 select o;
                                                        var pList = pr.ToList();
                                                        DistinConsumerListTBrk = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListTBrk)
                                                    {

                                                        var ListOfItem = ConsumerDtlListTBrk.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                        .GroupBy(a => a.ExtraItemId)
                                                        .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                        .ToList();
                                                        //var specificPersonChoiceList = ConsumerDtlListTBrk.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                        var usr = _userManager.Users.Where(x => x.Id == p).FirstOrDefault();
                                                    <tr>
                                                        <td>@usr.BUPNumber-@usr.BUPFullName</td>
                                                        @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                                if(tbrkTotalItemDict.ContainsKey(storeOutItemName))
                                                                {
                                                                    tbrkTotalItemDict[storeOutItemName] = (Int32.Parse(tbrkTotalItemDict[storeOutItemName])
                                                                        + spo.Amount).ToString();
                                                                }
                                                                else
                                                                {
                                                                    tbrkTotalItemDict.Add(storeOutItemName, spo.Amount.ToString());
                                                                }

                                                            }


                                                        <td>@ItemDetail</td>


                                                    </tr>
                                                    }

                                                    @{
                                                            var indexT = 0;

                                                            foreach (var i in tbrkTotalItemDict)
                                                            {
                                                        <tr>
                                                            @if (indexT++ == 0)
                                                                    {
                                                            <td rowspan="@tbrkTotalItemDict.Count">Total </td>
                                                                    }

                                                            <td> @i.Key - @i.Value   </td>
                                                        </tr>


                                                            }
                                                    }


                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                    <div class="@(subMenuDetect2== 2 ? "tab-pane active":"tab-pane")" id="TI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder2" asp-action="FetchItemOrder" asp-route-MealId="3" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item2" name="item2" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('TBreakItem',800,700,'TeaBreak',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>


                                            </div>
                                        </div>
                                        @{


                                            subMenuDetect = 2;



                                            var PreOrderSetMenuDetailListItmTBrk = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && x.MealTypeId == 3).ToList();
                                            var ItemOrderHistoryOnDay2 = _db.OrderHistory.Where(x => x.MealTypeId == 3 && x.StoreOutItemId != null && x.OrderDate.ToShortDateString() == OrderDate).Select(x => x.StoreOutItemId).Distinct().ToList();

                                            var OrderHistoryOnDay2 = _db.OrderHistory.Where(x => x.MealTypeId == 3 && x.OrderDate.ToShortDateString() == OrderDate).ToList();
                                            //var SetMenuList = _db.PreOrderSchedule.Where(x => x.MealTypeId == 1 && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 3)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    var or = from p in ItemList
                                                             join o in _db.ExtraItem
                                                              on p.Id equals o.StoreOutItemId
                                                             where o.Day == day && o.MealTypeId == 3
                                                             select o;
                                                    var di = from ro in or
                                                             join dib in DistinItemListTBrk
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListTBrk = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }
                                            // var SetMenuListBF = _db.PreOrderSchedule.Where(x => x.MealTypeId == 1 && x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString()).ToList();

                                            var SetMenuListTB = _db.SetMenu.Where(x => x.MealTypeId == 3 && x.SetMenuDate.ToShortDateString() == OrderDate).ToList();

                                            //var OnOffMealList = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.MealTypeId == mealId && x.LastModifiedDate.ToShortDateString() == ODate.AddDays(-1).ToShortDateString()).ToList();
                                            var OnOffMealListTB = _db.PreOrderSchedule.Where(x => x.IsPreOrderSet == true && x.MealTypeId == 3 && x.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString()).ToList();

                                            <div id="TBreakItem">

                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListTBrk)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListTBrk.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>
                                            </div>


                                        }


                                    </div>
                                </div>

                            </div>
                            <div class="@(lastUpdate == 2 ? "tab-pane active":"tab-pane")" id="lunch">

                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect3 == 1 ? "nav-link active" : "nav-link")" href="#LP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect3 == 2 ? "nav-link active" : "nav-link")" href="#LI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect3 == 1 ? "tab-pane active" : "tab-pane")" id="LP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder3" asp-action="FetchPersonOrder" asp-route-MealId="2" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person3" name="person3" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('LPerson',800,700,'Lunch',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>


                                            </div>
                                        </div>
                                        <div id="LPerson">
                                            <table class="table list-group" style="padding-left:75px;">
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 2)
                                                    {
                                                        var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial) || x.BUPNumber.Contains(personNamePartial)).ToList();

                                                        var pr = from p in PersonList
                                                                 join o in DistinConsumerListLnch
                                                                 on p.Id equals o
                                                                 // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                                 select o;
                                                        var pList = pr.ToList();
                                                        DistinConsumerListLnch = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListLnch)
                                                    {

                                                        var ListOfItem = ConsumerDtlListLnch.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                    .GroupBy(a => a.ExtraItemId)
                                                    .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                    .ToList();
                                                        //  var specificPersonChoiceList = ConsumerDtlListLnch.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                    var usr = _userManager.Users.Where(x => x.Id == p).FirstOrDefault();
                                                    <tr>
                                                        <td>@usr.BUPNumber-@usr.BUPFullName</td>

                                                        @foreach (var spo in liIQ)
                                                            {
                                                                long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == storeOutItemId).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                                if(lnTotalItemDict.ContainsKey(storeOutItemName))
                                                                {
                                                                    lnTotalItemDict[storeOutItemName] = (Int32.Parse(lnTotalItemDict[storeOutItemName])
                                                                        + spo.Amount).ToString();
                                                                }
                                                                else
                                                                {
                                                                    lnTotalItemDict.Add(storeOutItemName, spo.Amount.ToString());
                                                                }
                                                            }

                                                        <td>@ItemDetail</td>


                                                    </tr>
                                                    }

                                                    @{
                                                            var indexLn = 0;

                                                            foreach (var i in lnTotalItemDict)
                                                            {
                                                        <tr>
                                                            @if (indexLn++ == 0)
                                                                    {
                                                            <td rowspan="@lnTotalItemDict.Count">Total </td>
                                                                    }

                                                            <td> @i.Key - @i.Value   </td>
                                                        </tr>


                                                            }
                                                    }


                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="@(subMenuDetect3 == 2 ? "tab-pane active":"tab-pane")" id="LI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder3" asp-action="FetchItemOrder" asp-route-MealId="2" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item3" name="item3" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('LItem',800,700,'Lunch',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        @{


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 2)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    var or = from p in ItemList
                                                             join o in _db.ExtraItem
                                                              on p.Id equals o.StoreOutItemId
                                                             where o.Day == day && o.MealTypeId == 2
                                                             select o;
                                                    var di = from ro in or
                                                             join dib in DistinItemListLnch
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListLnch = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }

                                            <div id="LItem">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListLnch)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListLnch.Where(x => x.ExtraItemId == itm).ToList();
                                                                    long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == storeOutId).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>
                                            </div>


                                        }


                                    </div>





                                </div>
                            </div>
                            <div class="@(lastUpdate == 10005 ? "tab-pane active":"tab-pane")" id="EC">

                                <div class="card-header-danger" style="height:55px; padding-top:8px;">
                                    <div class="row" style="padding-top:0px;">
                                        <div class="col-md-6">
                                            <div class="nav-tabs-navigation">
                                                <div class="nav-tabs-wrapper">
                                                    <ul class="nav nav-tabs" data-tabs="tabs">
                                                        <li class="nav-item" style="padding-right:10px;padding-left:20px;">
                                                            <a class="@(subMenuDetect4 == 1 ? "nav-link active" : "nav-link")" href="#EP" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Person
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>
                                                        <li class="nav-item" style="padding-left:20px;">
                                                            <a class="@(subMenuDetect4 == 2 ? "nav-link active" : "nav-link")" href="#EI" data-toggle="tab">
                                                                <i class="material-icons">bug_report</i> Item
                                                                <div class="ripple-container"></div>
                                                            </a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>


                                </div>
                                <div class="tab-content">

                                    <div class="@(subMenuDetect4 == 1 ? "tab-pane active" : "tab-pane")" id="EP">


                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchPersonOrder4" asp-action="FetchPersonOrder" asp-route-MealId="10005" asp-route-SubMenuId="1" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="person4" name="person4" value="@personNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('ECPerson',800,700,'ExtraChit',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        <div id="ECPerson">
                                            <table class="table list-group" style="padding-left:75px;">
                                                @if (ViewBag.MealId != null)
                                                {
                                                    if (lastUpdate == 10005)
                                                    {
                                                        var PersonList = _userManager.Users.Where(x => x.BUPFullName.Contains(personNamePartial) || x.BUPNumber.Contains(personNamePartial)).ToList();

                                                        var pr = from p in PersonList
                                                                 join o in DistinConsumerListEC
                                                                 on p.Id equals o
                                                                 // where o.LastModifiedDate.ToShortDateString() == OD.AddDays(-1).ToShortDateString() && o.MealTypeId == 1
                                                                 select o;
                                                        var pList = pr.ToList();
                                                        DistinConsumerListEC = pList;
                                                        //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                        //PreOrderSetMenuDetailList = pList;
                                                    }
                                                }
                                                <tbody>
                                                    @foreach (var p in DistinConsumerListEC)
                                                    {
                                                        var ListOfItem = ConsumerDtlListEC.Where(x => x.UserId == p).ToList();


                                                        var liIQ = ListOfItem
                                                        .GroupBy(a => a.StoreOutItemId)
                                                        .Select(a => new { Amount = a.Sum(b => b.quantity), Name = a.Key })
                                                        .ToList();
                                                        // var specificPersonChoiceList = ConsumerDtlListEC.Where(x => x.UserId == p).ToList();
                                                        string ItemDetail = "";
                                                    var usr = _userManager.Users.Where(x => x.Id == p).FirstOrDefault();
                                                        <tr>
                                                            <td>@usr.BUPNumber-@usr.BUPFullName</td>
                                                            @foreach (var spo in liIQ)
                                                            {
                                                                //long storeOutItemId = _db.ExtraItem.Where(x => x.Id == spo.Name).FirstOrDefault().StoreOutItemId;
                                                                var storeOutItemName = _db.StoreOutItem.Where(x => x.Id == spo.Name).FirstOrDefault().Name;
                                                                ItemDetail += storeOutItemName + " - " + spo.Amount + " , ";
                                                                if(echitTotalItemDict.ContainsKey(storeOutItemName))
                                                                {
                                                                    echitTotalItemDict[storeOutItemName] = (Int32.Parse(echitTotalItemDict[storeOutItemName])
                                                                        + spo.Amount).ToString();
                                                                }
                                                                else
                                                                {
                                                                    echitTotalItemDict.Add(storeOutItemName, spo.Amount.ToString());
                                                                }

                                                            }

                                                            <td>@ItemDetail</td>


                                                        </tr>
                                                    }
                                               
                                                        @{
                                                            var index = 0;

                                                            foreach (var i in echitTotalItemDict)
                                                            {
                                                                <tr>
                                                                    @if (index++ == 0)
                                                                    {
                                                                 <td rowspan="@echitTotalItemDict.Count">Total </td>
                                                                    }

                                                                 <td> @i.Key - @i.Value   </td>
                                                                </tr>


                                                            }
                                                        }
                                                    

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="@(subMenuDetect4 == 2 ? "tab-pane active":"tab-pane")" id="EI">

                                        <div class="row">
                                            <div class="col-sm-7">

                                            </div>

                                            <div class="col-sm-4" style="padding-left:0px;">
                                                <form id="FetchItemOrder4" asp-action="FetchItemOrder" asp-route-MealId="10005" asp-route-SubMenuId="2" method="post">
                                                    <div class="input-group no-border">
                                                        <input type="text" id="item4" name="item4" value="@itemNamePartial" class="form-control" placeholder="Search...">
                                                        <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                                            <i class="material-icons">search</i>
                                                            <div class="ripple-container"></div>
                                                        </button>
                                                    </div>
                                                </form>

                                            </div>
                                            <div class="col-sm-1">
                                                <button onclick="Print('ECItem',800,700,'ExtraChit',@daay,@month,@year)" class="btn btn-white btn-round btn-just-icon">
                                                    <i class="material-icons">print</i>
                                                    <div class="ripple-container"></div>
                                                </button>

                                            </div>
                                        </div>
                                        @{


                                            @if (ViewBag.MealId != null)
                                            {
                                                if (lastUpdate == 10005)
                                                {
                                                    var ItemList = _db.StoreOutItem.Where(x => x.Name.Contains(itemNamePartial)).ToList();
                                                    //var or = from p in ItemList
                                                    //         join o in _db.ExtraItem
                                                    //          on p.Id equals o.StoreOutItemId
                                                    //where o.Day == day && o.MealTypeId == 2
                                                    //select o;
                                                    var di = from ro in ItemList
                                                             join dib in DistinItemListEC
                                                             on ro.Id equals dib
                                                             select dib;

                                                    //var oList = or.Select(x=>x.Id).Distinct().ToList();
                                                    DistinItemListEC = di.ToList();
                                                    //PreOrderSetMenuDetailList = _db.PreOrderSchedule.Include(x => x.SetMenu).Where(x => x.LastModifiedDate.ToShortDateString() == DateTime.Now.AddDays(-1).ToShortDateString() && x.MealTypeId == 1).ToList();

                                                }
                                            }
                                            <div id="ECItem">
                                                <table class="table list-group" style="padding-left:200px;">

                                                    <tbody>

                                                        @foreach (var itm in DistinItemListEC)
                                                        {
                                                            <tr>
                                                                @{var itemListDtl = ConsumerDtlListEC.Where(x => x.StoreOutItemId == itm).ToList();
                                                                    //long storeOutId = _db.ExtraItem.Where(x => x.Id == itm).FirstOrDefault().StoreOutItemId;
                                                                    string itmName = _db.StoreOutItem.Where(x => x.Id == itm).FirstOrDefault().Name;
                                                                    double qntt = itemListDtl.Sum(x => x.quantity);
                                                                }
                                                                <td>@itmName</td>
                                                                <td>@qntt</td>
                                                            </tr>
                                                        }


                                                    </tbody>

                                                </table>

                                            </div>


                                        }


                                    </div>





                                </div>
                            </div>
                        </div>
                    </div>


                </div>
                @*<div class="col-md-4">
                    <div class="card card-chart">
                        <div class="card-header card-header-warning">
                            <div class="ct-chart" id="websiteViewsChart"></div>
                        </div>
                        <div class="card-body">
                            <h4 class="card-title">Email Subscriptions</h4>
                            <p class="card-category">Last Campaign Performance</p>
                        </div>
                        <div class="card-footer">
                            <div class="stats">
                                <i class="material-icons">access_time</i> campaign sent 2 days ago
                            </div>
                        </div>
                    </div>
                </div>*@
                @*<div class="col-md-4">
                    <div class="card card-chart">
                        <div class="card-header card-header-danger">
                            <div class="ct-chart" id="completedTasksChart"></div>
                        </div>
                        <div class="card-body">
                            <h4 class="card-title">Completed Tasks</h4>
                            <p class="card-category">Last Campaign Performance</p>
                        </div>
                        <div class="card-footer">
                            <div class="stats">
                                <i class="material-icons">access_time</i> campaign sent 2 days ago
                            </div>
                        </div>
                    </div>
                </div>*@
            </div>

            <div class="col-sm-1">

            </div>
        </div>
    </div>
</div>
@*<div class="fixed-plugin">
        <div class="dropdown show-dropdown">
            <a href="#" onclick="OpenPartyModal()">
                <i class="fa fa-cog fa-2x"> </i>
            </a>


            <ul class="dropdown-menu" style="width:350px;">

                <li class="header-title"> Sidebar Filters</li>
                <li class="adjustments-line">
                    <a href="javascript:void(0)" class="switch-trigger active-color">
                        <div class="badge-colors ml-auto mr-auto">
                            <span class="badge filter badge-purple" data-color="purple"></span>
                            <span class="badge filter badge-azure" data-color="azure"></span>
                            <span class="badge filter badge-green" data-color="green"></span>
                            <span class="badge filter badge-warning" data-color="orange"></span>
                            <span class="badge filter badge-danger" data-color="danger"></span>
                            <span class="badge filter badge-rose active" data-color="rose"></span>
                        </div>
                        <div class="clearfix"></div>
                    </a>
                </li>
                <li class="header-title">Images</li>
                <li class="active">
                    <a class="img-holder switch-trigger" href="javascript:void(0)">
                        <img src="../assets/img/sidebar-1.jpg" alt="">
                    </a>
                </li>
                <li>
                    <a class="img-holder switch-trigger" href="javascript:void(0)">
                        <img src="../assets/img/sidebar-2.jpg" alt="">
                    </a>
                </li>
                <li>
                    <a class="img-holder switch-trigger" href="javascript:void(0)">
                        <img src="../assets/img/sidebar-3.jpg" alt="">
                    </a>
                </li>
                <li>
                    <a class="img-holder switch-trigger" href="javascript:void(0)">
                        <img src="../assets/img/sidebar-4.jpg" alt="">
                    </a>
                </li>
                <li class="button-container">
                    <a href="https://www.creative-tim.com/product/material-dashboard" target="_blank" class="btn btn-primary btn-block">Free Download</a>
                </li>

                <li class="button-container">
                    <a href="https://demos.creative-tim.com/material-dashboard/docs/2.1/getting-started/introduction.html" target="_blank" class="btn btn-default btn-block">
                        View Documentation
                    </a>
                </li>
                <li class="button-container github-star">
                    <a class="github-button" href="https://github.com/creativetimofficial/material-dashboard" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star ntkme/github-buttons on GitHub">Star</a>
                </li>
                <li class="header-title">Thank you for 95 shares!</li>
                <li class="button-container text-center">
                    <button id="twitter" class="btn btn-round btn-twitter"><i class="fa fa-twitter"></i> &middot; 45</button>
                    <button id="facebook" class="btn btn-round btn-facebook"><i class="fa fa-facebook-f"></i> &middot; 50</button>
                    <br>
                    <br>
                </li>

            </ul>

        </div>

    </div>*@


<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css" />
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>

@*<script type="text/javascript" src="~/assets/js/Jquery.min.js"></script>
    <script type="text/javascript" src="~/assets/js/jquery-ui.min.js"></script>*@


@*<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.min.js"
            asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
            asp-fallback-test="window.jQuery"
            crossorigin="anonymous"
            integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT">
    </script>*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>*@

<script src="~/js/AdminOnSpotController.js"></script>









@section Scripts {




    <script>
        $('#PartyInput').hide();
        $('#OfficeInput').hide();

        $('AfterPartyEdit').hide();


        var partyItem = [];
        var officeItem = [];

        function closePreModal(mealId) {
            if (mealId == 1) {
                var model = document.getElementById("PreBrkList");
                model.style.display = "none";
            }
            else if (mealId == 2) {
                var model = document.getElementById("PreLnList");
                model.style.display = "none";
            }
            else {
                var model = document.getElementById("PreTBrkList");
                model.style.display = "none";
            }

        }
        function printPreModal(mealId) {
            var mywindow = window.open('', 'PRINT', 'height=' + 1000 + ',width=' + 800);
            mywindow.document.write('<html><head></head><body>');
            mywindow.document.write(document.getElementById(mealId).innerHTML);
            mywindow.document.write('</body></html>');
            mywindow.document.close(); // necessary for IE >= 10
            mywindow.focus(); // necessary for IE >= 10*/

            mywindow.print();
        }


        function GetSpecialOnDate() {

            var date = document.getElementById("billdate").value.toString();

            $.ajax({
                url: '/mms/AdminShowOrder/GetSpecialOnDate',
                dataType: "json",
                data: { Date: date },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;
                    if (data[5][0] == '0') {
                        alert("Date is not allowed for printing.");
                    }
                    else {



                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Person/Reference </th><th>Office</th><th>Item</th><th></th> ';
                        editHTML += '  </tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var person = data[3].find(x => x.Id == data[1][i].UserId);

                            var name = "-";
                            var offname = "-";
                            var office = data[4].find(x => x.Id == data[1][i].OfficeId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                            if (person != undefined) {
                                name = person.BUPFullName;
                            }
                            if (office != undefined) {
                                offname = office.Name;
                            }










                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-12">' + dt + '</div></div></td>';
                            //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-12">' + name + '</div></div></td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-12">' + offname + '</div></div></td><td>';
                            //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-4">' + data[0][j].UnitOrdered + '</div>';
                                    //editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice('+data[0][j].Id+')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '</div>';

                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';
                        }


                        editHTML += '</tbody></table>'





                        $('#SpecialPrintDB').hide();
                        //$('#OfficeDB').hide();
                        //$('#OfficeEditOption').hide();
                        //$('#OfficeDateEditOption').hide();
                        //$('#OfficeNameEditOption').hide();
                        //                    $('#AfterOfficeBack').hide();

                        //$('#AfterOfficeEdit').hide();
                        //                                        $('#AfterOfficeNameEdit').hide();


                        $('#SpecialOnDate').show();


                        document.getElementById("SpecialOnDate").innerHTML = editHTML;
                    }
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });





        }


        function SpecialPrint(Id) {

            $.ajax({
                url: '/AdminShowOrder/SpecialPrint',
                dataType: "json",
                data: { Id: Id },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;
                    var name = "";
                    var dt = "";
                    var offname = "";
                    var splitprintdt = data[5][1].split("/");
                    printdt = splitprintdt[1] + "-" + splitprintdt[0] + "-" + splitprintdt[2];
                    var admin = data[5][0];

                    editHTML += '<br><br><br><div align="center"><table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>Item</th><th>Quantity </th><th>Unit Price</th><th>Total Price</th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var person = data[3].find(x => x.Id == data[1][i].UserId);


                        var office = data[4].find(x => x.Id == data[1][i].OfficeId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                        if (person != undefined) {
                            name = person.BUPFullName;
                        }
                        if (office != undefined) {
                            offname = office.Name;
                        }










                        //editHTML += '<tr><td>' + sl + '</td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + dt + '</div></div></td>';
                        //     //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + name + '</div></div></td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + offname + '</div></div></td><td>';
                        //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';

                        var ttlPrice = 0;
                        var ttlBill = 0;

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {
                                ttlPrice = data[0][j].UnitOrdered * soi.Price;
                                ttlBill += ttlPrice;
                                editHTML += '<tr><td>' + soi.Name + '</td><td>' + data[0][j].UnitOrdered + '</td><td>' + soi.Price + ' Tk</td><td>' + ttlPrice + ' Tk</td></tr>'

                                //editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice('+data[0][j].Id+')" class="btn"><i class="fas fa-edit"></i></button></div>';

                            }

                        }



                        editHTML += '<tr><td></td><td></td><td>Total Bill </td><td>' + ttlBill + '</td></tr>';
                    }


                    editHTML += '</tbody></table></div>';




                    var mywindow = window.open('', 'PRINT', 'height=' + 1000 + ',width=' + 800);
                    mywindow.document.write('<html>    ');
                    mywindow.document.write('<head> <style>  td {    border-style: solid;border-width: thin;border-color:grey }</style> <head>')






                    //mywindow.document.write(headerhtml.toString());
                    mywindow.document.write('<body style="text-align: center; padding:1em;">');
                    if (data[1][0].MealTypeId == 10006) {
                        mywindow.document.write('<h2>' + 'Party Order' + '</h2>');

                        mywindow.document.write('<h3> Person :' + name + '</h3>');
                        mywindow.document.write('<h3> Date :' + dt + '</h3>');
                    }
                    else {
                        mywindow.document.write('<h2>' + 'Office Order' + '</h2>');
                        mywindow.document.write('<h3> Office :' + offname + '</h3>');

                        mywindow.document.write('<h3> Reference :' + name + '</h3>');
                        mywindow.document.write('<h3> Date :' + dt + '</h3>');

                    }

                    //mywindow.document.write('<table><tr><td>Session </td><td>' + s.toString() + '</td></tr><tr><td>Program </td><td>' + p.toString() + '</td></tr><tr><td>Course </td><td>' + c.toString() + '</td></tr></table></br>');
                    //mywindow.document.write('<table><tr><td>Mean Marks </td><td>' + meanmark + '</td></tr><tr><td>Mean Grade Point </td><td>' + meanGradePOint + '</td></tr><tr><td>Faculty Performance Index </td><td>' + facultyPerformanceIndex + '</td></tr><tr><td>Standard Deviation Of Marks </td><td>' + stdDeviationMark + '</td></tr><tr><td>Standard Grade Points </td><td>' + stadGradePoint + '</td></tr><tr><td>Course Evaluation Score </td><td>' + courseEvaluationScore + '</td></tr><tr><td>Threshold Value </td><td>' + parsed.ThresholdValue +'</td></tr><tr><td>CO Level </td><td>'+LblCourseOutcomeValue + '</td></tr></table></br>')
                    mywindow.document.write(editHTML);

                    mywindow.document.write('<br><br><br><p style="float:left;">' + printdt + ' <p style="float:right">' + admin + '</p></p>')


                    mywindow.document.write('<br><p style="float:left;margin-left:-115px;"> Printed Date <p style="float:right;margin-right:-80px;">Printed By</p></p>')
                    //mywindow.document.write('<br style="line-height:50%;"><p class="b" style="float:left;line-height:2px;">Date:'+date+'</p>')


                    //mywindow.document.write('<table><tr><td>Ammendment   </td><td> ' + amd + '</td></tr><tr><td>Recommendation & Proposal    </td><td>' + parsed.RecommendationAndProposal + '</td></tr><tr><td>Attainments Satisfaction   </td><td>' + atm + '</td></tr><tr><td>Attainment Comments   </td><td>' + parsed.AttainmentsComments + '</td></tr><tr><td>Instructor Comments&Feedback  </td><td>' + parsed.CommentAndFeedback + '</td></tr><tr><td>Recommendation1   </td><td>' + parsed.SuggestionAndRecommendation1 + '</td></tr><tr><td>Recommendation2   </td><td>' + parsed.SuggestionAndRecommendation2 + '</td></tr><tr><td>Recommendation3  </td><td>' + parsed.SuggestionAndRecommendation3 + '</td></tr></table></br>');

                    mywindow.document.write('</body></html>');

                    mywindow.document.close(); // necessary for IE >= 10
                    mywindow.focus(); // necessary for IE >= 10*/

                    mywindow.print();
                    //mywindow.close();













                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });


        }



        function SpecialTempPrint(Id) {

            $.ajax({
                url: '/AdminShowOrder/SpecialPrint',
                dataType: "json",
                data: { Id: Id },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;
                    var name = "";
                    var dt = "";
                    var offname = "";
                    var splitprintdt = data[5][1].split("/");
                    printdt = splitprintdt[1] + "-" + splitprintdt[0] + "-" + splitprintdt[2];
                    var admin = data[5][0];

                    editHTML += '<br><br><br><div align="center"><table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>Item</th><th>Quantity </th><th>Unit Price</th><th>Total Price</th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var person = data[3].find(x => x.Id == data[1][i].UserId);


                        var office = data[4].find(x => x.Id == data[1][i].OfficeId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                        if (person != undefined) {
                            name = person.BUPFullName;
                        }
                        if (office != undefined) {
                            offname = office.Name;
                        }










                        //editHTML += '<tr><td>' + sl + '</td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + dt + '</div></div></td>';
                        //     //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + name + '</div></div></td>';

                        //editHTML += '<td> <div class="row"> <div class="col-sm-12">' + offname + '</div></div></td><td>';
                        //editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';

                        var ttlPrice = 0;
                        var ttlBill = 0;

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {
                                ttlPrice = data[0][j].UnitOrdered * soi.Price;
                                ttlBill += ttlPrice;
                                editHTML += '<tr><td>' + soi.Name + '</td><td>' + data[0][j].UnitOrdered + '</td><td>' + soi.Price + ' Tk</td><td>' + ttlPrice + ' Tk</td></tr>'

                                //editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice('+data[0][j].Id+')" class="btn"><i class="fas fa-edit"></i></button></div>';

                            }

                        }



                        editHTML += '<tr><td></td><td></td><td>Total Bill </td><td>' + ttlBill + '</td></tr>';
                    }


                    editHTML += '</tbody></table></div>';




                    var mywindow = window.open('', 'PRINT', 'height=' + 1000 + ',width=' + 800);
                    mywindow.document.write('<html>    ');
                    mywindow.document.write('<head> <style>  td {    border-style: solid;border-width: thin;border-color:grey }</style> <head>')






                    //mywindow.document.write(headerhtml.toString());
                    mywindow.document.write('<body style="text-align: center; padding:1em;">');
                    if (data[1][0].MealTypeId == 10006) {
                        mywindow.document.write('<h2>' + 'Party Order' + '</h2>');

                        mywindow.document.write('<h3> Person :' + name + '</h3>');
                        mywindow.document.write('<h3> Date :' + dt + '</h3>');
                    }
                    else {
                        mywindow.document.write('<h2>' + 'Office Order' + '</h2>');
                        mywindow.document.write('<h3> Office :' + offname + '</h3>');

                        mywindow.document.write('<h3> Reference :' + name + '</h3>');
                        mywindow.document.write('<h3> Date :' + dt + '</h3>');

                    }

                    //mywindow.document.write('<table><tr><td>Session </td><td>' + s.toString() + '</td></tr><tr><td>Program </td><td>' + p.toString() + '</td></tr><tr><td>Course </td><td>' + c.toString() + '</td></tr></table></br>');
                    //mywindow.document.write('<table><tr><td>Mean Marks </td><td>' + meanmark + '</td></tr><tr><td>Mean Grade Point </td><td>' + meanGradePOint + '</td></tr><tr><td>Faculty Performance Index </td><td>' + facultyPerformanceIndex + '</td></tr><tr><td>Standard Deviation Of Marks </td><td>' + stdDeviationMark + '</td></tr><tr><td>Standard Grade Points </td><td>' + stadGradePoint + '</td></tr><tr><td>Course Evaluation Score </td><td>' + courseEvaluationScore + '</td></tr><tr><td>Threshold Value </td><td>' + parsed.ThresholdValue +'</td></tr><tr><td>CO Level </td><td>'+LblCourseOutcomeValue + '</td></tr></table></br>')
                    mywindow.document.write(editHTML);

                    mywindow.document.write('<br><br><br><p style="float:left;">' + printdt + ' <p style="float:right">' + admin + '</p></p>')


                    mywindow.document.write('<br><p style="float:left;margin-left:-115px;"> Printed Date <p style="float:right;margin-right:-80px;">Printed By</p></p>')
                    //mywindow.document.write('<br style="line-height:50%;"><p class="b" style="float:left;line-height:2px;">Date:'+date+'</p>')


                    //mywindow.document.write('<table><tr><td>Ammendment   </td><td> ' + amd + '</td></tr><tr><td>Recommendation & Proposal    </td><td>' + parsed.RecommendationAndProposal + '</td></tr><tr><td>Attainments Satisfaction   </td><td>' + atm + '</td></tr><tr><td>Attainment Comments   </td><td>' + parsed.AttainmentsComments + '</td></tr><tr><td>Instructor Comments&Feedback  </td><td>' + parsed.CommentAndFeedback + '</td></tr><tr><td>Recommendation1   </td><td>' + parsed.SuggestionAndRecommendation1 + '</td></tr><tr><td>Recommendation2   </td><td>' + parsed.SuggestionAndRecommendation2 + '</td></tr><tr><td>Recommendation3  </td><td>' + parsed.SuggestionAndRecommendation3 + '</td></tr></table></br>');

                    mywindow.document.write('</body></html>');

                    mywindow.document.close(); // necessary for IE >= 10
                    mywindow.focus(); // necessary for IE >= 10*/

                    mywindow.print();
                    //mywindow.close();













                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });


        }



        function Test() {
            console.log('Dip');
            //$('#fileUploadModal').modal('show');
            window.alert("lolololololo");
        }

        $(function () {
            $("#datepicker").datepicker({
                dateFormat: "dd-mm-yy"
                , duration: "fast"
            });
        });

        $(function () {
            $("#partydate").datepicker({
                dateFormat: "dd-mm-yy"
                , duration: "fast"
            });
        });

        $(function () {
            $("#billdate").datepicker({
                dateFormat: "dd-mm-yy"
                , duration: "fast"
            });
        });

        $(function () {
            $("#officedate").datepicker({
                dateFormat: "dd-mm-yy"
                , duration: "fast"
            });
        });


        $("#party").attr("aria-expanded", "true");



        var input = $('#ordTime');
        input.clockpicker({
            autoclose: true
        });

        //$("#person").on('change input', function () {
        //    fetchPerson();

        //});
        //$("#person2").on('change input', function () {
        //    fetchPerson2();
        //});
        //$("#person3").on('change input', function () {
        //    fetchPerson3();
        //});
        //$("#person4").on('change input', function () {
        //    fetchPerson4();
        //});

        //   $('.clockpicker').clockpicker({
        //  'default': 'now',
        //  vibrate: true,
        //  placement: "top",
        //  align: "left",
        //  autoclose: false,
        //  twelvehour: true
        //});
        //$('.clockpicker').clockpicker();

        //$('#datetimepicker3').datetimepicker({
        //    format: 'LT'
        //});

        function OpenPartyInput() {

            $('#PartyEditOption').hide();
            $('#PartyPersonEditOption').hide();
            $('#PartyDateEditOption').hide();
            $('#AfterPartyDateEdit').hide();
            $('#AfterPartyNameEdit').hide();
            $('#AfterPartyEdit').hide();
            $('#PartyDB').hide();

            $('#AfterBack').hide();
            $('#PartyInput').show();

        }
        function OpenOfficeInput() {

            $('#OfficeEditOption').hide();
            $('#OfficeNameEditOption').hide();
            $('#OfficeDateEditOption').hide();
            $('#AfterOfficeDateEdit').hide();
            $('#AfterOfficeNameEdit').hide();
            $('#AfterOfficeEdit').hide();
            $('#OfficeDB').hide();

            $('#AfterOfficeBack').hide();
            $('#OfficeInput').show();

        }

        function CloseParty() {
            document.getElementById('partyperson').value = '';
            document.getElementById('partyitem').value = '';
            document.getElementById('partydate').value = '';
            document.getElementById('piq').value = '';
            document.getElementById('pr').value = '';


            $.ajax({
                url: '@Url.Action("FetchSpecialMenu", "AdminShowOrder")',

                dataType: "json",
                data: { Id: 10006 },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> <th></th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var user = data[3].find(x => x.Id == data[1][i].UserId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                        editHTML += '<tr><td>' + sl + '</td>';

                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + user.BUPFullName + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                            }

                        }


                        editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                        editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';

                        //editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'




                    $('#PartyEditOption').hide();
                    $('#PartyPersonEditOption').hide();
                    $('#PartyDateEditOption').hide();
                    $('#AfterPartyDateEdit').hide();
                    $('#AfterPartyNameEdit').hide();
                    $('#AfterPartyEdit').hide();
                    $('#PartyDB').hide();
                    $('#PartyInput').hide();
                    $('#InputDetail').hide();


                    $('#AfterBack').show();



                    document.getElementById("AfterBack").innerHTML = editHTML;
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });



        }




        function CloseOffice() {

            document.getElementById('officeperson').value = '';
            document.getElementById('officeitem').value = '';
            document.getElementById('officename').value = '';

            document.getElementById('officedate').value = '';
            document.getElementById('oiq').value = '';
            document.getElementById('offpr').value = '';

            $.ajax({
                url: '/AdminShowOrder/FetchSpecialMenu',
                dataType: "json",
                data: { Id: 10007 },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th><th></th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var office = data[3].find(x => x.Id == data[1][i].OfficeId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                        editHTML += '<tr><td>' + sl + '</td>';

                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + office.Name + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                            }

                        }



                        editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                        editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                    }


                    editHTML += '</tbody></table>'

                    $('#OfficeEditOption').hide();
                    $('#OfficeNameEditOption').hide();
                    $('#OfficeDateEditOption').hide();
                    $('#AfterOfficeDateEdit').hide();
                    $('#AfterOfficeNameEdit').hide();
                    $('#AfterOfficeEdit').hide();
                    $('#OfficeDB').hide();
                    $('#OfficeInput').hide();
                    $('#OfficeInputDetail').hide();





                    $('#AfterOfficeBack').show();



                    document.getElementById("AfterOfficeBack").innerHTML = editHTML;
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });









        }


        function EditParty(id) {
            console.log(id);
            $.ajax({
                url: '@Url.Action("GetSpecialMenuEdit", "AdminShowOrder")',
                dataType: "json",
                data: {},
                success: function (data) {
                    console.log(data);

                    $('#PartyDB').hide();
                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += ' </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var user = data[3].find(x => x.Id == data[1][i].UserId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                        editHTML += '<tr><td>' + sl + '</td><td>' + dt + '</td><td>' + user.BUPFullName + '</td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {
                                if (data[0][j].Id == id) {

                                    itmnm = soi.Name;
                                    itmq = data[0][j].UnitOrdered;

                                    editHTML += '<div class="row"><div class="col-sm-8"><div class="form-group"><input type="text" name="ei" id="ei" class="form-control" value="" /></div></div>';
                                    editHTML += '<div id="edititembox"></div>';
                                    editHTML += '<div class="col-sm-3"><input type="text" name="eiq" id="eiq" class="form-control" value="" /></div>';
                                    editHTML += '<div class="col-sm-1"><button type="button" style="padding:2px;" rel="tooltip" onclick="SaveParty(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div>';
                                    // document.getElementById('ei').value = product(2, 3);
                                }
                                else {
                                    editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-3">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-1"></div></div>';
                                }
                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseParty()" class="btn">Back</button>';
                    editHTML += '</div></div>';











                    $('#PartyEditOption').show();
                    $('#PartyPersonEditOption').hide();
                    $('#PartyDateEditOption').hide();
                    $('#AfterPartyDateEdit').hide();
                    $('#AfterPartyNameEdit').hide();
                    $('#AfterPartyEdit').hide();
                    $('#PartyDB').hide();
                    $('#PartyInput').hide();


                    $('#AfterBack').hide();



                    document.getElementById("PartyEditOption").innerHTML = editHTML;
                    document.getElementById('ei').value = itmnm;
                    document.getElementById('eiq').value = itmq;
                    $("#ei").autocomplete({
                        source: function (request, response) {
                            $.ajax({
                                url: '/AdminShowOrder/GetSearchItem',
                                dataType: "json",
                                data: { search: $("#ei").val() },
                                success: function (data) {
                                    console.log('Hiiii');
                                    console.log(data.length);
                                    console.log(data);
                                    var a = [];
                                    for (var i = 0; i < data.length; i++) {

                                        a.push(data[i].name);
                                    }
                                    //console.log(a);

                                    response(a);
                                    $("#edititembox").show();

                                },
                                error: function (xhr, status, error) {
                                    alert("Error");
                                }
                            });
                        }
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }


        function EditPartyDate(id) {
            console.log(id);
            $.ajax({
                url: '@Url.Action("GetSpecialMenuEdit", "AdminShowOrder")',
                dataType: "json",
                data: {},
                success: function (data) {
                    console.log(data);

                    $('#PartyDB').hide();
                    var editHTML = "";
                    var sl = 0;
                    var orddate = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var user = data[3].find(x => x.Id == data[1][i].UserId);
                        console.log(user);

                        editHTML += '<tr><td>' + sl + '</td>';


                        if (data[1][i].Id == id) {
                            editHTML += '<td><div class="row"><div class="col-sm-8"><input type="text" name="eod" id="eod" class="form-control" value="" /></div>';
                            editHTML += '<div class="col-sm-2"><button type="button" style="padding:5px;" rel="tooltip" onclick="SavePartyDate(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';
                            orddate = data[1][i].OrderDate.toString();


                        }
                        else {
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            editHTML += '<td>' + splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0] + '</td>';


                        }


                        editHTML += '<td>' + user.BUPFullName + '</td><td>';

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {

                                editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-3">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-1"></div></div>';

                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseParty()" class="btn">Back</button>';
                    editHTML += '</div></div>';




                    $('#PartyEditOption').hide();
                    $('#PartyPersonEditOption').hide();
                    $('#AfterPartyDateEdit').hide();
                    $('#AfterPartyNameEdit').hide();
                    $('#AfterPartyEdit').hide();
                    $('#PartyDB').hide();
                    $('#PartyInput').hide();

                    $('#AfterBack').hide();


                    //$('#AfterPartyNameEdit').hide();

                    console.log(orddate);
                    var b = 'tbgrb rtbrtbbrtbrrrr btbrb';
                    var d = orddate.slice(0, 10);
                    var splitstr = d.split("-");
                    console.log(d);
                    $('#PartyDateEditOption').show();


                    document.getElementById("PartyDateEditOption").innerHTML = editHTML;
                    document.getElementById('eod').value = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];


                    $(function () {
                        $("#eod").datepicker({
                            dateFormat: "dd-mm-yy"
                            , duration: "fast"
                        });
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }




        function EditPartyName(id) {
            console.log(id);
            $.ajax({

                url: '@Url.Action("GetSpecialMenuEdit", "AdminShowOrder")',
                dataType: "json",
                data: {},
                success: function (data) {
                    console.log(data);

                    $('#PartyDB').hide();
                    var editHTML = "";
                    var sl = 0;
                    var ordpr = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '</tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var user = data[3].find(x => x.Id == data[1][i].UserId);
                        console.log(user);

                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");

                        editHTML += '<tr><td>' + sl + '</td>';
                        editHTML += '<td>' + splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0] + '</td>';



                        if (data[1][i].Id == id) {
                            editHTML += '<td><div class="row"><div class="col-sm-8"><input type="text" name="eop" id="eop" class="form-control" value="" /></div>';
                            editHTML += '<div id="eopbox"></div>';
                            editHTML += '<div class="col-sm-2"><button type="button" style="padding:5px;" rel="tooltip" onclick="SavePartyName(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';
                            ordpr = user.BUPFullName;


                        }
                        else {
                            editHTML += '<td>' + user.BUPFullName + '</td>';



                        }

                        editHTML += '<td>';

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {

                                editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"></div></div>';

                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseParty()" class="btn">Back</button>';
                    editHTML += '</div></div>';




                    $('#PartyEditOption').hide();
                    $('#PartyDateEditOption').hide();
                    $('#AfterPartyDateEdit').hide();
                    $('#AfterPartyNameEdit').hide();
                    $('#AfterPartyEdit').hide();
                    $('#PartyDB').hide();
                    $('#PartyInput').hide();

                    $('#AfterBack').hide();



                    $('#PartyPersonEditOption').show();




                    document.getElementById("PartyPersonEditOption").innerHTML = editHTML;
                    document.getElementById('eop').value = ordpr;


                    $("#eop").autocomplete({
                        source: function (request, response) {
                            $.ajax({
                                url: '/AdminShowOrder/GetSearchPerson',

                                dataType: "json",
                                data: { search: $("#eop").val() },
                                success: function (data) {
                                    console.log('Hiiii');
                                    console.log(data.length);
                                    console.log(data);
                                    var a = [];
                                    for (var i = 0; i < data.length; i++) {

                                        a.push(data[i].bupFullName);
                                    }
                                    //console.log(a);

                                    response(a);
                                    $("#eopbox").show();

                                },
                                error: function (xhr, status, error) {
                                    alert("Error");
                                }
                            });
                        }
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }






        function EditOffice(id) {
            console.log(id);
            $.ajax({
                url: '/AdminShowOrder/GetSpecialOfficeMenuEdit',
                dataType: "json",
                data: {},
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var office = data[3].find(x => x.Id == data[1][i].OfficeId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                        editHTML += '<tr><td>' + sl + '</td><td>' + dt + '</td><td>' + office.Name + '</td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {
                                if (data[0][j].Id == id) {

                                    itmnm = soi.Name;
                                    itmq = data[0][j].UnitOrdered;

                                    editHTML += '<div class="row"><div class="col-sm-8"><div class="form-group"><input type="text" name="oei" id="oei" class="form-control" value="" /></div></div>';
                                    editHTML += '<div id="edititembox"></div>';
                                    editHTML += '<div class="col-sm-3"><input type="text" name="oeiq" id="oeiq" class="form-control" value="" /></div>';
                                    editHTML += '<div class="col-sm-1"><button type="button" style="padding:2px;" rel="tooltip" onclick="SaveOffice(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div>';
                                    // document.getElementById('ei').value = product(2, 3);
                                }
                                else {
                                    editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-3">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-1"></div></div>';
                                }
                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>';

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseOffice()" class="btn">Back</button>';
                    editHTML += '</div></div>';




                    $('#OfficeEditOption').show();
                    $('#OfficeNameEditOption').hide();
                    $('#OfficeDateEditOption').hide();
                    $('#AfterOfficeDateEdit').hide();
                    $('#AfterOfficeNameEdit').hide();
                    $('#AfterOfficeEdit').hide();
                    $('#OfficeDB').hide();
                    $('#OfficeInput').hide();

                    $('#AfterOfficeDelete').hide();

                    $('#AfterOfficeBack').hide();
                    //document.getElementById("OfficeEditOption")
                    document.getElementById("OfficeEditOption").innerHTML = editHTML;
                    document.getElementById('oei').value = itmnm;
                    document.getElementById('oeiq').value = itmq;
                    $("#oei").autocomplete({
                        source: function (request, response) {
                            $.ajax({
                                url: '/mms/AdminShowOrder/GetSearchItem',
                                dataType: "json",
                                data: { search: $("#oei").val() },
                                success: function (data) {
                                    console.log('Hiiii');
                                    console.log(data.length);
                                    console.log(data);
                                    var a = [];
                                    for (var i = 0; i < data.length; i++) {

                                        a.push(data[i].name);
                                    }
                                    //console.log(a);

                                    response(a);
                                    $("#editofficeitembox").show();

                                },
                                error: function (xhr, status, error) {
                                    alert("Error");
                                }
                            });
                        }
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }


        function EditOfficeDate(id) {
            $.ajax({
                url: '/AdminShowOrder/GetSpecialOfficeMenuEdit',
                dataType: "json",
                data: {},
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var orddate = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var office = data[3].find(x => x.Id == data[1][i].OfficeId);

                        editHTML += '<tr><td>' + sl + '</td>';


                        if (data[1][i].Id == id) {
                            editHTML += '<td><div class="row"><div class="col-sm-8"><input type="text" name="eofd" id="eofd" class="form-control" value="" /></div>';
                            editHTML += '<div class="col-sm-2"><button type="button" style="padding:5px;" rel="tooltip" onclick="SaveOfficeDate(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';
                            orddate = data[1][i].OrderDate.toString();


                        }
                        else {
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            editHTML += '<td>' + splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0] + '</td>';


                        }


                        editHTML += '<td>' + office.Name + '</td><td>';

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {

                                editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-3">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-1"></div></div>';

                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseOffice()" class="btn">Back</button>';
                    editHTML += '</div></div>';




                    $('#OfficeEditOption').hide();
                    $('#OfficeNameEditOption').hide();
                    $('#AfterOfficeDateEdit').hide();
                    $('#AfterOfficeNameEdit').hide();
                    $('#AfterOfficeEdit').hide();
                    $('#OfficeDB').hide();
                    $('#OfficeInput').hide();
                    $('#AfterOfficeDelete').hide();

                    $('#AfterOfficeBack').hide();



                    var d = orddate.slice(0, 10);
                    var splitstr = d.split("-");
                    $('#OfficeDateEditOption').show();


                    document.getElementById("OfficeDateEditOption").innerHTML = editHTML;
                    document.getElementById('eofd').value = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];


                    $(function () {
                        $("#eofd").datepicker({
                            dateFormat: "dd-mm-yy"
                            , duration: "fast"
                        });
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }


        function EditOfficeName(id) {
            $.ajax({
                url: '/AdminShowOrder/GetSpecialOfficeMenuEdit',
                dataType: "json",
                data: {},
                success: function (data) {

                    var editHTML = "";
                    var sl = 0;
                    var ordpr = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '</tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var office = data[3].find(x => x.Id == data[1][i].OfficeId);

                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");

                        editHTML += '<tr><td>' + sl + '</td>';
                        editHTML += '<td>' + splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0] + '</td>';



                        if (data[1][i].Id == id) {
                            editHTML += '<td><div class="row"><div class="col-sm-8"><input type="text" name="eof" id="eof" class="form-control" value="" /></div>';
                            editHTML += '<div id="eofbox"></div>';
                            editHTML += '<div class="col-sm-2"><button type="button" style="padding:5px;" rel="tooltip" onclick="SaveOfficeName(' + id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';
                            ordpr = office.Name;


                        }
                        else {
                            editHTML += '<td>' + office.Name + '</td>';

                        }

                        editHTML += '<td>';

                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {

                                editHTML += '<div class="row"><div class="col-sm-8">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"></div></div>';

                            }

                        }



                        editHTML += '</td></tr>';
                    }


                    editHTML += '</tbody></table>'

                    editHTML += '<div class="row"> <div class="col-md-9"></div><div class="col-md-3">';
                    editHTML += ' <button id="myBtn" rel="tooltip" style="padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;" onclick="CloseOffice()" class="btn">Back</button>';
                    editHTML += '</div></div>';




                    $('#OfficeEditOption').hide();
                    $('#OfficeDateEditOption').hide();
                    $('#AfterOfficeDateEdit').hide();
                    $('#AfterOfficeNameEdit').hide();
                    $('#AfterOfficeEdit').hide();
                    $('#OfficeDB').hide();
                    $('#OfficeInput').hide();
                    $('#AfterOfficeDelete').hide();

                    $('#AfterOfficeBack').hide();



                    $('#OfficeNameEditOption').show();




                    document.getElementById("OfficeNameEditOption").innerHTML = editHTML;
                    document.getElementById('eof').value = ordpr;


                    $("#eof").autocomplete({
                        source: function (request, response) {
                            $.ajax({
                                url: '/AdminShowOrder/GetSearchOffice',
                                dataType: "json",
                                data: { search: $("#eof").val() },
                                success: function (data) {
                                    console.log('Hiiii');
                                    console.log(data.length);
                                    console.log(data);
                                    var a = [];
                                    for (var i = 0; i < data.length; i++) {

                                        a.push(data[i].name);
                                    }
                                    //console.log(a);

                                    response(a);
                                    $("#eofbox").show();

                                },
                                error: function (xhr, status, error) {
                                    alert("Error");
                                }
                            });
                        }
                    });





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

        }


        function OpenPreOrderModel(mealId) {
            if (mealId == 1) {
                var model = document.getElementById("PreBrkList");
                model.style.display = "block";
            }
            else if (mealId == 2) {
                var model = document.getElementById("PreLnList");
                model.style.display = "block";
            }
            else {
                var model = document.getElementById("PreTBrkList");
                model.style.display = "block";
            }

        }


        function fetchPerson() {
            $('#FetchPersonOrder').submit();
        }
        function fetchPerson2() {
            $('#FetchPersonOrder2').submit();
        }
        function fetchPerson3() {
            $('#FetchPersonOrder3').submit();
        }
        function fetchPerson4() {
            $('#FetchPersonOrder4').submit();
        }

        //$("#item").on('change input', function () {
        //    fetchItem();
        //});
        //$("#item2").on('change input', function () {
        //    fetchItem2();
        //});
        //$("#item3").on('change input', function () {
        //    fetchItem3();
        //});

        //$("#item4").on('change input', function () {
        //    fetchItem4();
        //});
        function Print(id, height, width, meal, day, month, year) {




            var mywindow = window.open('', 'PRINT', 'height=' + height + ',width=' + width);
            mywindow.document.write('<html>    ');
            mywindow.document.write('<head> <style>  td {    border-style: solid;border-width: thin;border-color:grey }</style> <head>')

            var currentDate = new Date();
            cd = currentDate.toString();
            curDate = cd.split(' ');
          



            //mywindow.document.write(headerhtml.toString());
            mywindow.document.write('<body style="text-align: center; padding:1em;">');
            mywindow.document.write('<img src="../../images/bup_logo.png" height="50" />');

            mywindow.document.write('<h2>' + meal + '</h2>');
            mywindow.document.write('<h3>' + curDate[1] + ' ' + curDate[2] + ', ' + curDate[3] + '</h3>');
            //mywindow.document.write('<table><tr><td>Session </td><td>' + s.toString() + '</td></tr><tr><td>Program </td><td>' + p.toString() + '</td></tr><tr><td>Course </td><td>' + c.toString() + '</td></tr></table></br>');
            //mywindow.document.write('<table><tr><td>Mean Marks </td><td>' + meanmark + '</td></tr><tr><td>Mean Grade Point </td><td>' + meanGradePOint + '</td></tr><tr><td>Faculty Performance Index </td><td>' + facultyPerformanceIndex + '</td></tr><tr><td>Standard Deviation Of Marks </td><td>' + stdDeviationMark + '</td></tr><tr><td>Standard Grade Points </td><td>' + stadGradePoint + '</td></tr><tr><td>Course Evaluation Score </td><td>' + courseEvaluationScore + '</td></tr><tr><td>Threshold Value </td><td>' + parsed.ThresholdValue +'</td></tr><tr><td>CO Level </td><td>'+LblCourseOutcomeValue + '</td></tr></table></br>')
            mywindow.document.write(document.getElementById(id).innerHTML);

            //mywindow.document.write('<table><tr><td>Ammendment   </td><td> ' + amd + '</td></tr><tr><td>Recommendation & Proposal    </td><td>' + parsed.RecommendationAndProposal + '</td></tr><tr><td>Attainments Satisfaction   </td><td>' + atm + '</td></tr><tr><td>Attainment Comments   </td><td>' + parsed.AttainmentsComments + '</td></tr><tr><td>Instructor Comments&Feedback  </td><td>' + parsed.CommentAndFeedback + '</td></tr><tr><td>Recommendation1   </td><td>' + parsed.SuggestionAndRecommendation1 + '</td></tr><tr><td>Recommendation2   </td><td>' + parsed.SuggestionAndRecommendation2 + '</td></tr><tr><td>Recommendation3  </td><td>' + parsed.SuggestionAndRecommendation3 + '</td></tr></table></br>');

            mywindow.document.write('</body></html>');

            mywindow.document.close();
            mywindow.focus();
            mywindow.print();


        }
        function fetchItem() {
            $('#FetchItemOrder').submit();
        }
        function fetchItem2() {
            $('#FetchItemOrder2').submit();
        }
        function fetchItem3() {
            $('#FetchItemOrder3').submit();
        }
        function fetchItem4() {
            $('#FetchItemOrder4').submit();
        }
        jQuery.noConflict();

        $("#officeperson").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AdminShowOrder/GetSearchPerson',
                    dataType: "json",
                    data: { search: $("#officeperson").val() },
                    success: function (data) {
                        console.log('Hiiii');
                        console.log(data.length);
                        console.log(data);
                        var a = [];
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].bupFullName);
                        }
                        //console.log(a);

                        response(a);
                        $("#officepersonbox").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });
        $("#officename").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AdminShowOrder/GetSearchOffice',
                    dataType: "json",
                    data: { search: $("#officename").val() },
                    success: function (data) {
                        console.log('Hiiii');
                        console.log(data.length);
                        console.log(data);
                        var a = [];
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].name);
                        }
                        //console.log(a);

                        response(a);
                        $("#officebox").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });

        $("#partyperson").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetSearchPerson","AdminShowOrder")',
                    dataType: "json",
                    data: { search: $("#partyperson").val() },
                    success: function (data) {
                        console.log('Hiiii');
                        console.log(data.length);
                        console.log(data);
                        var a = [];
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].bupFullName);
                        }
                        //console.log(a);

                        response(a);
                        $("#partypersonbox").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });

        $("#searchInput").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetSearchPerson","AdminShowOrder")',
                    dataType: "json",
                    data: { search: $("#searchInput").val() },
                    success: function (data) {
                        console.log('Hiiii');
                        console.log(data);
                        var a = [];
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].bupFullName);
                        }
                        console.log(a);

                        response(a);
                        $("#suggesstion-box").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });


        $("#partyitem").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetSearchItem", "AdminShowOrder")',
                    dataType: "json",
                    data: { search: $("#partyitem").val() },
                    success: function (data) {
                        console.log(data.length);
                        console.log(data);
                        var a = [];
                        partyItem = [];
                        if (data.length == 0) {
                            $("#PriceDiv").css("display", "block");
                            partyItem = [];
                        }
                        else {
                            $("#PriceDiv").css("display", "none");
                            partyItem = data;
                        }
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].name);
                        }
                        //console.log(a);

                        response(a);
                        $("#partyitembox").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });


        $("#officeitem").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AdminShowOrder/GetSearchItem',
                    dataType: "json",
                    data: { search: $("#officeitem").val() },
                    success: function (data) {
                        console.log('Hiiii');
                        console.log(data.length);
                        console.log(data);
                        var a = [];
                        officeItem = [];
                        if (data.length == 0) {
                            $("#OffPriceDiv").css("display", "block");
                            officeItem = [];
                        }
                        else {
                            $("#OffPriceDiv").css("display", "none");
                            officeItem = data;
                        }
                        for (var i = 0; i < data.length; i++) {

                            a.push(data[i].name);
                        }
                        //console.log(a);

                        response(a);
                        $("#officeitembox").show();

                    },
                    error: function (xhr, status, error) {
                        alert("Error");
                    }
                });
            }
        });



        function AddPartyItem() {


            var person = document.getElementById("partyperson").value.toString();
            var item = document.getElementById("partyitem").value.toString();
            var date = document.getElementById("partydate").value.toString();

            var q = document.getElementById("piq").value.toString();
            var price = 0;
            console.log('check ' + partyItem.length);
            if (partyItem.length == 0) {
                price = document.getElementById("pr").value.toString();

            }



            $.ajax({
                url: '@Url.Action("AddPartyItem", "AdminShowOrder")',
                dataType: "json",
                data: { Person: person, Item: item, Date: date, Quantity: q, Price: price },
                success: function (data) {
                    //console.log(data[1]);
                    var errorCheck = data[data.length - 1][0];
                    if (errorCheck == "1") {
                        alert(data[0][0]);
                    }
                    else {
                        var order = "";

                        order += "<p>";
                        for (var i = 0; i < data[0].length; i++) {

                            var sto = data[1].find(x => x.Id == data[0][i].StoreOutItemId);
                            console.log(sto);
                            order += "  " + sto.Name + " - " + data[0][i].UnitOrdered + " , ";
                        }

                        order += "</p>"

                        document.getElementById("InputDetail").innerHTML = order;
                    }
                    //console.log(JSON.parse(response.d));
                    //console.log('Hiiii');
                    //console.log(data.length);
                    //console.log(data);
                    //var a = [];
                    //for (var i = 0; i < data.length; i++) {

                    //    a.push(data[i].bupFullName);
                    //}
                    ////console.log(a);

                    //response(a);
                    //$("#officepersonbox").show();

                },
                error: function (xhr, status, error) {
                    console.log(error);
                    alert(error);
                }
            });


            console.log(person + item + q);


        }
        function AddOfficeItem() {


            var person = document.getElementById("officeperson").value.toString();
            var item = document.getElementById("officeitem").value.toString();
            var q = document.getElementById("oiq").value.toString();
            var office = document.getElementById("officename").value.toString();
            var officeDate = document.getElementById("officedate").value.toString();
            var price = 0;

            if (officeItem.length == 0) {
                price = document.getElementById("offpr").value.toString();
            }


            $.ajax({
                url: '/AdminShowOrder/AddOfficeItem',
                dataType: "json",
                data: { Person: person, Office: office, Item: item, Date: officeDate, Quantity: q, Price: price },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {
                        var order = "";

                        order += "<p>";
                        for (var i = 0; i < data[0].length; i++) {

                            var sto = data[1].find(x => x.Id == data[0][i].StoreOutItemId);
                            console.log(sto);
                            order += "  " + sto.Name + " - " + data[0][i].UnitOrdered + " , ";
                        }

                        order += "</p>"

                        document.getElementById("OfficeInputDetail").innerHTML = order;
                    }
                    //console.log(JSON.parse(response.d));
                    //console.log('Hiiii');
                    //console.log(data.length);
                    //console.log(data);
                    //var a = [];
                    //for (var i = 0; i < data.length; i++) {

                    //    a.push(data[i].bupFullName);
                    //}
                    ////console.log(a);

                    //response(a);
                    //$("#officepersonbox").show();

                },
                error: function (xhr, status, error) {
                    console.log(error);
                    alert(error);
                }
            });





            console.log(person + item + q);


        }

        function SaveParty(Id) {
            // var person = document.getElementById("partyperson").value.toString();
            var item = document.getElementById("ei").value.toString();
            // var date = document.getElementById("partydate").value.toString();

            var q = document.getElementById("eiq").value.toString();

            $.ajax({
                 url: '@Url.Action("SaveSpecialMenuEdit", "AdminShowOrder")',

                dataType: "json",
                data: { Id: Id, Item: item, Quantity: q },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {

                        $('#PartyDB').hide();
                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;



                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += ' <th></th></tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var user = data[3].find(x => x.Id == data[1][i].UserId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + user.BUPFullName + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';


                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'




                        $('#PartyInput').hide();
                        $('#PartyDB').hide();
                        $('#PartyEditOption').hide();

                        $('#AfterPartyEdit').show();



                        document.getElementById("AfterPartyEdit").innerHTML = editHTML;
                    }
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }


        function SavePartyDate(Id) {
           // console.log('dip');
            // var person = document.getElementById("partyperson").value.toString();
            var date = document.getElementById("eod").value.toString();
            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                //url: '/mms/AdminShowOrder/SaveSpecialMenuDateEdit',
               url: '@Url.Action("SaveSpecialMenuDateEdit", "AdminShowOrder")',

                dataType: "json",
                data: { Date: date, Id: Id },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {
                        $('#PartyDB').hide();
                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;


                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += '<th></th>  </tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var user = data[3].find(x => x.Id == data[1][i].UserId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + user.BUPFullName + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'




                        $('#PartyInput').hide();
                        $('#PartyDB').hide();
                        $('#PartyEditOption').hide();
                        $('#PartyDateEditOption').hide();


                        $('#AfterPartyDateEdit').show();


                        document.getElementById("AfterPartyDateEdit").innerHTML = editHTML;
                        //document.getElementById('ei').value = itmnm;
                        //document.getElementById('eiq').value = itmq;
                    }





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }



        function SavePartyName(Id) {
            console.log('dip');
            // var person = document.getElementById("partyperson").value.toString();
            var person = document.getElementById("eop").value.toString();
            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                url: '@Url.Action("SaveSpecialMenuNameEdit", "AdminShowOrder")',


                dataType: "json",
                data: { Person: person, Id: Id },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {
                        $('#PartyDB').hide();
                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;


                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += ' <th></th></tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var user = data[3].find(x => x.Id == data[1][i].UserId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + user.BUPFullName + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';


                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'




                        $('#PartyInput').hide();
                        $('#PartyDB').hide();
                        $('#PartyEditOption').hide();
                        $('#PartyDateEditOption').hide();
                        $('#PartyPersonEditOption').hide();
                        $('#AfterBack').hide();

                        $('#AfterPartyNameEdit').show();







                        document.getElementById("AfterPartyNameEdit").innerHTML = editHTML;
                        //document.getElementById('ei').value = itmnm;
                        //document.getElementById('eiq').value = itmq;


                    }


                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }



        function DeleteParty(Id) {

            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                url: '@Url.Action("DeleteSpecialMenu", "AdminShowOrder")',

                dataType: "json",
                data: { Id: Id },
                success: function (data) {
                    console.log(data);

                    $('#PartyDB').hide();
                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += ' <th></th> </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var user = data[3].find(x => x.Id == data[1][i].UserId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                        editHTML += '<tr><td>' + sl + '</td>';

                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + user.BUPFullName + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditPartyName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditParty(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteParty(' + data[1][i].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                            }

                        }



                        editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                        editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                    }


                    editHTML += '</tbody></table>'






                    $('#PartyInput').hide();
                   // $('#PartyDB').hide();
                    $('#PartyEditOption').hide();
                    $('#PartyDateEditOption').hide();
                    $('#PartyPersonEditOption').hide();
                    $('#AfterPartyDateEdit').hide();
                    $('#AfterPartyNameEdit').hide();
                    $('#AfterPartyEdit').hide();

                    $('#AfterBack').hide();





                    document.getElementById("AfterPartyDelete").innerHTML = editHTML;
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }







        function SaveOffice(Id) {
            console.log('dip');
            // var person = document.getElementById("partyperson").value.toString();
            var item = document.getElementById("oei").value.toString();
            // var date = document.getElementById("partydate").value.toString();

            var q = document.getElementById("oeiq").value.toString();

            $.ajax({
                //url: '/mms/AdminShowOrder/SaveSpecialOfficeMenuEdit',

                url: '@Url.Action("SaveSpecialOfficeMenuEdit", "AdminShowOrder")',

                dataType: "json",
                data: { Id: Id, Item: item, Quantity: q },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {

                        $('#OfficeDB').hide();
                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;


                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += '<th></th></tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var office = data[3].find(x => x.Id == data[1][i].OfficeId);


                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                            editHTML += '<tr><td>' + sl + '</td>';
                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + office.Name + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';


                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';


                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'





                        $('#OfficeInput').hide();
                        $('#OfficeDB').hide();
                        $('#OfficeEditOption').hide();
                        $('#OfficeDateEditOption').hide();
                        $('#OfficeNameEditOption').hide();
                        $('#AfterOfficeBack').hide();

                        $('#AfterOfficeDateEdit').hide();
                        $('#AfterOfficeNameEdit').hide();




                        $('#AfterOfficeEdit').show();
                        document.getElementById("AfterOfficeEdit").innerHTML = editHTML;
                        //document.getElementById('ei').value = itmnm;
                        //document.getElementById('eiq').value = itmq;

                    }



                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }


        function SaveOfficeDate(Id) {
            // var person = document.getElementById("partyperson").value.toString();
            var date = document.getElementById("eofd").value.toString();
            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                url: '/AdminShowOrder/SaveSpecialMenuDateEdit',

                dataType: "json",
                data: { Date: date, Id: Id },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {

                        $('#PartyDB').hide();
                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;


                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += ' <th></th> </tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var office = data[3].find(x => x.Id == data[1][i].OfficeId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + office.Name + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'





                        $('#OfficeInput').hide();
                        $('#OfficeDB').hide();
                        $('#OfficeEditOption').hide();
                        $('#OfficeDateEditOption').hide();
                        $('#OfficeNameEditOption').hide();
                        $('#AfterOfficeBack').hide();

                        $('#AfterOfficeEdit').hide();
                        $('#AfterOfficeNameEdit').hide();


                        $('#AfterOfficeDateEdit').show();


                        document.getElementById("AfterOfficeDateEdit").innerHTML = editHTML;
                        //document.getElementById('ei').value = itmnm;
                        //document.getElementById('eiq').value = itmq;


                    }


                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }


        function SaveOfficeName(Id) {
            // var person = document.getElementById("partyperson").value.toString();
            var person = document.getElementById("eof").value.toString();
            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                url: '/AdminShowOrder/SaveSpecialMenuNameEdit',
                dataType: "json",
                data: { Person: person, Id: Id },
                success: function (data) {
                    if (data[data.length - 1][0] == "1") {
                        alert(data[0][0]);
                    }
                    else {

                        var editHTML = "";
                        var sl = 0;
                        var itmnm = "";
                        var itmq = 0;


                        editHTML += '<table class="table table-striped table-bordered table-hover">';
                        editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                        editHTML += ' <th></th></tr>  </thead> <tbody>'
                        for (var i = 0; i < data[1].length; i++) {
                            sl++;

                            var office = data[3].find(x => x.Id == data[1][i].OfficeId);
                            var d = data[1][i].OrderDate.slice(0, 10);
                            var splitstr = d.split("-");
                            var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];

                            editHTML += '<tr><td>' + sl + '</td>';

                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                            editHTML += '<td> <div class="row"> <div class="col-sm-10">' + office.Name + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                            editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                            for (var j = 0; j < data[0].length; j++) {
                                var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                                if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                    editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                    editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';


                                }

                            }



                            editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                            editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                        }


                        editHTML += '</tbody></table>'




                        $('#OfficeInput').hide();
                        $('#OfficeDB').hide();
                        $('#OfficeEditOption').hide();
                        $('#OfficeDateEditOption').hide();
                        $('#OfficeNameEditOption').hide();
                        $('#AfterOfficeBack').hide();

                        $('#AfterOfficeEdit').hide();
                        $('#AfterOfficeDateEdit').hide();

                        $('#AfterOfficeNameEdit').show();







                        document.getElementById("AfterOfficeNameEdit").innerHTML = editHTML;
                        //document.getElementById('ei').value = itmnm;
                        //document.getElementById('eiq').value = itmq;

                    }



                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }


        function DeleteOffice(Id) {

            // var date = document.getElementById("partydate").value.toString();


            $.ajax({
                url: '/AdminShowOrder/DeleteSpecialMenu',
                dataType: "json",
                data: { Id: Id },
                success: function (data) {
                    console.log(data);

                    var editHTML = "";
                    var sl = 0;
                    var itmnm = "";
                    var itmq = 0;


                    editHTML += '<table class="table table-striped table-bordered table-hover">';
                    editHTML += ' <thead><tr><th>#</th><th>Date</th><th>Name</th><th>Item</th> ';
                    editHTML += '<th></th>  </tr>  </thead> <tbody>'
                    for (var i = 0; i < data[1].length; i++) {
                        sl++;

                        var office = data[3].find(x => x.Id == data[1][i].OfficeId);
                        var d = data[1][i].OrderDate.slice(0, 10);
                        var splitstr = d.split("-");
                        var dt = splitstr[2] + "-" + splitstr[1] + "-" + splitstr[0];







                        editHTML += '<tr><td>' + sl + '</td>';

                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + dt + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeDate(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td>';


                        editHTML += '<td> <div class="row"> <div class="col-sm-10">' + office.Name + '</div><div class="col-sm-2" style="padding-left: 0; margin-left: -10px;">';
                        editHTML += ' <button type="button" style="padding:2px;" rel="tooltip" onclick="EditOfficeName(' + data[1][i].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div></div></td><td>';
                        for (var j = 0; j < data[0].length; j++) {
                            var soi = data[2].find(x => x.Id == data[0][j].StoreOutItemId);
                            if (data[1][i].Id == data[0][j].SpecialMenuParentId) {


                                editHTML += '<div class="row"><div class="col-sm-6">' + soi.Name + '</div><div class="col-sm-2">' + data[0][j].UnitOrdered + '</div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="EditOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-edit"></i></button></div>';
                                editHTML += '<div class="col-sm-2"><button type="button" rel="tooltip" style="padding:2px;" onclick="DeleteOffice(' + data[0][j].Id + ')" class="btn"><i class="fas fa-trash"></i></button></div></div>';

                            }

                        }



                        editHTML += '</td><td><button onclick="SpecialTempPrint(' + data[1][i].Id + ')" class="btn btn-white btn-round btn-just-icon">';
                        editHTML += '<i class="material-icons">print</i><div class="ripple-container"></div> </button></td></tr>';


                    }


                    editHTML += '</tbody></table>'




                    $('#OfficeInput').hide();
                    $('#OfficeDB').hide();
                    $('#OfficeEditOption').hide();
                    $('#OfficeDateEditOption').hide();
                    $('#OfficeNameEditOption').hide();
                    $('#AfterOfficeBack').hide();

                    $('#AfterOfficeNameEdit').hide();
                    $('#AfterOfficeDateEdit').hide();
                    $('#AfterOfficeEdit').hide();


                    $('#AfterOfficeDelete').show();





                    document.getElementById("AfterOfficeDelete").innerHTML = editHTML;
                    //document.getElementById('ei').value = itmnm;
                    //document.getElementById('eiq').value = itmq;





                },
                error: function (xhr, status, error) {
                    alert("Error");
                }
            });

            //console.log(item + q);

        }




        $(document).ready(function () {

            var date = new Date();

            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            if (month < 10) month = "0" + month;
            if (day < 10) day = "0" + day;

            var today = year + "-" + month + "-" + day;
            // document.getElementById('from').value = today;

        });



        function OnspotOrder() {
            var x = document.getElementById('Label1').innerText;
            var ddlCategory = document.getElementById("DDLCategory");
            var categoryId = ddlCategory.options[ddlCategory.selectedIndex].value.toString();
            console.log(categoryId);
            console.log(x);


            $.ajax({

                url: '/mms/AdminShowOrder/CreateOnspotOrder',
                type: "POST",
                data: { MealTypeId: categoryId, ItemId: x },
                success: function (response) {
                    if (response.success) {

                        //jQuery("#messageUp").append('<div class="alert alert-success" role="alert"><b>"' + response.responseText + '"</b></div>');

                        //window.alert(response.responseText);
                        //        //jQuery("#messageUp").append('<div class="alert alert-success" role="alert"><b>"' + response.responseText + '"</b></div>');
                        //window.location.reload(true);


                    } else {
                        // DoSomethingElse()
                        alert(response.responseText);
                    }
                }


            })


        }
        function test() {

        }
        function setOrderTime() {
            var time = document.getElementById('ordTime').value.toString();
            $.ajax({

                url: '/AdminShowOrder/SetOrderTime',
                type: "POST",
                dataType: "json",
                data: { OrderTime: time },
                success: function (response) {
                    alert("New last order time " + response[0]);
                },
                error: function (Error) {
                    alert(Error);
                }


            })


        }

        function UpdateSetMenuList() {

            //=============== Set Menu Id =================
            var setMenuIdTemp = $('#setMenuId').val();
            //alert(setMenuIdTemp);
            //=============== Set Menu Id =================


            //=============== Set Menu Item Id =================
            var setMenuArray = [];
            var setMenuPrice = document.getElementById("setMenuPrice").value.toString();

            var checkBoxSetMenu = document.getElementsByName("checkMainItem");
            var checkBoxLengthSetMenu = checkBoxSetMenu.length;
            var tempItemValueSetMenu = "";
            for (var i = 0; i < checkBoxLengthSetMenu; i++) {
                if (checkBoxSetMenu[i].checked == true) {

                    tempItemValueSetMenu = checkBoxSetMenu[i].value.toString();
                    var obj = { SetMenuItemId: tempItemValueSetMenu };
                    setMenuArray.push(obj);
                }
            }
            //=============== Set Menu Item Id =================


            //=============== Extra Item Id =================
            var addedItem = [];
            var checkBoxAdded = document.getElementsByName("checkExtraItem");
            var checkBoxLengthAdded = checkBoxAdded.length;
            var textsAdded = document.getElementsByName("extraItemPrice");
            var tempItemValueAdded = "";
            var tempPriceValueAdded = "";
            for (var i = 0; i < checkBoxLengthAdded; i++) {
                if (checkBoxAdded[i].checked == true) {
                    tempPriceValueAdded = textsAdded[i].value.toString();
                    tempItemValueAdded = checkBoxAdded[i].value.toString();
                    var obj = { AddedItemId: tempItemValueAdded, AddedItemPrice: tempPriceValueAdded };
                    addedItem.push(obj);
                }
            }
            //=============== Extra Item Id =================

            var tempExtraItemList = "";
            var tempSetMenuList = "";
            tempExtraItemList = JSON.stringify(addedItem);
            tempSetMenuList = JSON.stringify(setMenuArray);



            $.ajax({

                url: '/mms/SetMenu/UpdateSetMenuAndAddedItemList',
                type: "POST",
                data: { SetMenuList: tempSetMenuList, ExtraItemList: tempExtraItemList, SetMenuId: setMenuIdTemp, SetMenuPrice: setMenuPrice },
                success: function (response) {
                    if (response.success) {

                        //alert(response.responseText);
                        //window.location.reload(true);




                        jQuery("#messageUp").append('<div class="alert alert-success" role="alert"><b>"' + response.responseText + '"</b></div>');
                        jQuery("#messageDown").append('<div class="alert alert-success" role="alert"><b>"' + response.responseText + '"</b></div>');


                    } else {
                        // DoSomethingElse()
                        //alert(response.responseText);
                        jQuery("#messageUp").append('<div class="alert alert-danger" role="alert"><b>"' + response.responseText + '"</b></div>');
                        jQuery("#messageDown").append('<div class="alert alert-danger" role="alert"><b>"' + response.responseText + '"</b></div>');
                    }
                }


            })




        }







        //<<<<<<<<<<<<<<<<<< CleanPriceFieldOfExtraItem >>>>>>>>>>>>>>>>>>>>>>>
        function CleanPriceFieldOfExtraItem(storeOutItemId) {

            var isChecked = $('#checkadded_' + storeOutItemId).is(":checked");
            if (isChecked == true) {
                //alert('is checked');
            } else {
                //alert('is not checked');
                $('#priceadded_' + storeOutItemId).val('');

            }

        }

        //fixed_plugin_open = $('.sidebar .sidebar-wrapper .nav li.active a p').html();

        //    if (window_width > 767 && fixed_plugin_open == 'Dashboard') {
        //      if ($('.fixed-plugin .dropdown').hasClass('show-dropdown')) {
        //        $('.fixed-plugin .dropdown').addClass('open');
        //      }

        //    }

        //    $('.fixed-plugin a').click(function(event) {
        //      // Alex if we click on switch, stop propagation of the event, so the dropdown will not be hide, otherwise we set the  section active
        //      if ($(this).hasClass('switch-trigger')) {
        //        if (event.stopPropagation) {
        //          event.stopPropagation();
        //        } else if (window.event) {
        //          window.event.cancelBubble = true;
        //        }
        //      }
        //    });
        //<<<<<<<<<<<<<<<<<< CleanPriceFieldOfExtraItem >>>>>>>>>>>>>>>>>>>>>>>

        function OpenPartyModal() {
            var modal = document.getElementById("myModal");

            // Get the button that opens the modal

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];

            // When the user clicks the button, open the modal
            modal.style.display = "block";


            // When the user clicks on <span> (x), close the modal
            span.onclick = function () {
                modal.style.display = "none";
            }

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }

            }
        }


    </script>



    <script>



        $(".nav a").on("click", function () {
            $(".nav").find(".active").removeClass("active");
            $(this).parent().addClass("active");
        });
    </script>

}


